---
title: luoguè“æ¡¥5_19
date: 2024-08-14 19:46:31
tags: [luogu]
categories: 
	- æ¯”èµ›
	- æ¨¡æ‹Ÿèµ›
	- è“æ¡¥æ¨¡æ‹Ÿ
---

## B. åœè½¦åœº

[P10509 åœè½¦åœº - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)](https://www.luogu.com.cn/problem/P10509?contestId=174155)

### é¢˜æ„

ä½ æœ‰ä¸€ç‰‡ç©ºåœ°ã€‚è¿™ç‰‡ç©ºåœ°å¯ä»¥è§†ä½œä¸€ä¸ªä¸€ä¸ª ð‘›Ã—ð‘› çš„æ­£æ–¹å½¢ã€‚ç©ºåœ°å¤–ä¸€åœˆä¸ºå¢™å£ï¼Œä½ æ— æ³•æ‹†é™¤å®ƒä»¬ã€‚

çŽ°åœ¨ä½ è¦åœ¨è¿™ç‰‡ç©ºåœ°ä¸Šè§„åˆ’åœè½¦ä½ï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªåœè½¦åœºã€‚ä½ å¸Œæœ›ç©ºåœ°çš„å·¦ä¸‹è§’æ˜¯åœè½¦åœºçš„å‡ºå…¥å£ã€‚å‡ºå…¥å£ä¸èƒ½è§„åˆ’ä¸ºåœè½¦ä½ã€‚ç©ºåœ°å’Œåœè½¦ä½éƒ½æ˜¯ 1Ã—1çš„æ­£æ–¹å½¢ï¼Œä¸”æ­£æ–¹å½¢çš„æ¯æ¡è¾¹ä¸Žå¢™å£å¹³è¡Œæˆ–è€…åž‚ç›´ã€‚

æ¯ä¸ªåœè½¦ä½éƒ½åº”è¯¥ä¸Žè‡³å°‘ä¸€ä¸ªç©ºåœ°å››è¿žé€šï¼ˆå³ï¼šåœè½¦åœºçš„ä¸Šã€ä¸‹ã€å·¦ã€å³æ–¹è‡³å°‘æœ‰ä¸€ä¸ªç©ºåœ°ï¼‰ï¼Œä¸”è¿™ä¸ªç©ºåœ°åº”å½“èƒ½é€šè¿‡è‹¥å¹²æ¬¡å‘ä¸Šã€ä¸‹ã€å·¦ã€å³çš„ç§»åŠ¨ï¼Œåœ¨ä¸ç»è¿‡ä»»ä½•åœè½¦ä½çš„æƒ…å†µä¸‹åˆ°è¾¾å‡ºå…¥å£ã€‚

ä¸‹å›¾ä¸º ð‘›=4 æ—¶åœè½¦ä½æ•°æœ€å¤šçš„æ”¾ç½®æ–¹æ³•ä¹‹ä¸€ï¼Œå…¶ä¸­çº¢è‰²ä¸ºè½¦ä½ï¼Œè“è‰²ä¸ºå‡ºå£ï¼Œç™½è‰²ä¸ºç©ºåœ°ã€‚

![img](https://cdn.luogu.com.cn/upload/image_hosting/r3qljdsr.png)

è¯·é—® ð‘›=2023 ä¸‹æœ€å¤šèƒ½å®‰æŽ’å¤šå°‘ä¸ªåœè½¦ä½ï¼Ÿ

### é¢˜è§£

è¿™é¢˜çœŸæ˜¯ä¸€é“ç¥žå¥‡è€Œåˆå¤æ‚çš„é¢˜ç›®ï¼Œæˆ‘æƒ³å¦‚æžœå›½èµ›æœ‰è¿™ç§é¢˜ï¼Œå¯èƒ½åˆšå¼€å§‹å¿ƒæ€å°±ä¼šçˆ†ç‚¸

[äº‘å‰ªè´´æ¿ - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)](https://www.luogu.com.cn/paste/17rwjfcz)

æ´›è°·å®˜æ–¹å¯¹è¿™é¢˜åšå‡ºäº†éžå¸¸è¯¦ç»†çš„è§£é‡Šï¼Œä½†èµ›æ—¶è¯æ˜Žæ˜¯åœ¨è¿‡äºŽç¹çï¼Œå¦‚æžœçœŸçš„è“æ¡¥ï¼Œä¸‡ä¸€çœŸæœ‰è¿™ç§æƒ…å†µå»ºè®®ç›´æŽ¥æ”¾æŽ‰è¿™é¢˜ã€‚

è¿™é¢˜çš„å…¶ä¸­ä¸€ç§æž„é€ æ–¹æ³•éžå¸¸åƒâ€œminecraftâ€é‡Œçš„é±¼éª¨æŒ–çŸ¿æ³•å³ä¸‹å›¾ç¬¬äºŒç§

![img](https://cdn.luogu.com.cn/upload/image_hosting/xjhz5uvs.png)

ç›´æŽ¥æž„é€ å¯å¾—

ç­”æ¡ˆä¸º(2022+2021*(674*2-1)+673*2*2+3)

## D. æ–¹å·®

[P10511 æ–¹å·® - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)](https://www.luogu.com.cn/problem/P10511?contestId=174155)

### é¢˜æ„

å° S è®¤ä¸ºæ•°å­¦å¾ˆç®€å•ï¼ŒäºŽæ˜¯å° R æƒ³è¦è€ƒè€ƒå¥¹ã€‚

å° R ç»™äº†å° S ä¸€ä¸ªåºåˆ— $a$ï¼Œè¿™ä¸ªåºåˆ—ç”± $m$ æ®µæž„æˆï¼Œç¬¬ $i$ æ®µè¢«è¡¨ç¤ºä¸º `l r b`ï¼Œè¡¨ç¤º $a_l,a_{l+1},\ldots,a_r$ ä¸º $b$ï¼Œä¿è¯ç»™å‡ºçš„ä»»æ„ä¸¤ä¸ªåŒºé—´ä¸ç›¸äº¤ã€‚

çŽ°åœ¨ï¼Œå° R æœ‰ $q$ ä¸ªé—®é¢˜ã€‚å½¢å¦‚ `l r`ï¼Œæƒ³è®©ä½ æŸ¥è¯¢åŒºé—´ $[l,r]$ çš„æ–¹å·® $s^2$ï¼ˆéœ€è¦æ³¨æ„ï¼š$l$ å¯èƒ½ç­‰äºŽ $r$ï¼Œæ­¤æ—¶è¯¥æ®µæ–¹å·®ä¸º $0$ï¼‰ã€‚

ç”±äºŽè¿™ä¸ªæ•°å­—å¯èƒ½æ˜¯ä¸ªå°æ•°ï¼Œå° R ä¸æ–¹ä¾¿å¯¹ç­”æ¡ˆï¼Œæ‰€ä»¥ä»–æƒ³è¦å° S æ±‚å‡º $(r-l+1)^2\cdot s^2\bmod 998244353$ã€‚å¯ä»¥è¯æ˜Ž $(r-l+1)^2\cdot s^2$ ä¸€å®šæ˜¯æ•´æ•°ã€‚

ä½œä¸ºå° S çš„å¥½æœ‹å‹ï¼Œä½ èƒ½å¸®å¸®å¥¹å—ï¼Ÿ

### é¢˜è§£

æŽ¨å¯¼ä¸€ä¸‹å…¬å¼å‘çŽ°ç»“æžœæ˜¯

$$(r-l+1) \sum_{i=l}^{r-l+1}a_i^2 - sum^2$$

é¢„å¤„ç†å‰ç¼€å’Œå’Œå‰ç¼€å¹³æ–¹å’Œï¼ŒäºŒåˆ†æŸ¥æ‰¾å³å¯ç«¯ç‚¹æ‰€åœ¨åŒºé—´å³å¯ã€‚

ä½†ä¸€å®šéœ€è¦æ³¨æ„å¤šæ¬¡å–æ¨¡ï¼Œç»è¿‡ä¸€ä¸ªå°æ—¶çš„é–æˆ˜ï¼Œé‰´å®šä¸ºå–æ¨¡é¢˜

```cpp
void slove() {
	cin>>n>>m>>k;
	for(int i=1;i<=m;i++) {
		cin>>seg[i].l>>seg[i].r>>seg[i].v;
		seg[i].l %= MOD;
		seg[i].r %= MOD;
		seg[i].v %= MOD;
	}

	// sort(seg+1,seg+1+m);

	for(int i=1;i<=m;i++){
		segs[i] = segs[i-1] + ((((seg[i].r - seg[i].l  + 1) %MOD + MOD) %MOD) * seg[i].v) % MOD;
		segs[i] %= MOD;
		segs2[i] = segs2[i-1] + (((((seg[i].r - seg[i].l + 1) %MOD + MOD)%MOD) * seg[i].v %MOD)
				* seg[i].v) % MOD;
		segs2[i] %= MOD;
	}

	// for(int i=1;i<=m;i++) cout<<segs[i]<<' '<<segs2[i]<<endl;

	while(k--){
		int l,r;cin>>l>>r;
		int li = upper_bound(seg+1,seg+1+m,(Segment){l,0,0}) - seg - 1;
		int ri = upper_bound(seg+1,seg+1+m,(Segment){r,0,0}) - seg - 1;
		// cout<<"###"<<li<< ' ' << ri<<endl;

		if(li== ri)
    	{
      		cout<<0<<"\n";
      		continue;
    	}

		int msum = ((segs[ri-1] - segs[li])%MOD + MOD) % MOD;
		msum %= MOD;
		int rsum = (((r - seg[ri].l + 1) % MOD + MOD) % MOD * seg[ri].v) % MOD;
		rsum %= MOD;
		int lsum = ((seg[li].r - l + 1 + MOD) % MOD * seg[li].v) % MOD;
		lsum %= MOD;
		int msum2 = ((segs2[ri-1] - segs2[li])%MOD + MOD) %MOD;
		msum %=MOD;
		int rsum2 = ((((r - seg[ri].l + 1)%MOD + MOD) % MOD * seg[ri].v) % MOD
				* seg[ri].v) % MOD;
		rsum2%=MOD;
		int lsum2 = ((((seg[li].r - l + 1) %MOD + MOD) % MOD * seg[li].v) % MOD
				*seg[li].v) %MOD;
		lsum2 %=MOD;
		// cout<<"---"<<lsum << ' '<<msum<< ' '<<rsum<<endl;
		int sum = lsum + msum % MOD + rsum %MOD;
		sum %=MOD;
		int sum2 = lsum2 + msum2 % MOD + rsum2 %MOD;
		sum2%=MOD;
		// cout<<"####"<<sum<< ' '<< sum2<<endl;
		cout<<(((((r-l+1) %MOD + MOD) % MOD * sum2) % MOD -
							(sum*sum) %MOD) % MOD +MOD) %MOD<<endl;
	}
}
```

## E. åºåˆ—åˆå¹¶

https://www.luogu.com.cn/problem/P10512?contestId=174155

## é¢˜æ„

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º ð‘›çš„éžè´Ÿæ•´æ•°åºåˆ— {$$ð‘Ž_ð‘›$$}ï¼Œä½ å¯ä»¥è¿›è¡Œ ð‘˜æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œä½ é€‰æ‹©ä¸¤ä¸ªç›¸é‚»çš„æ•°ï¼ŒæŠŠå®ƒä»¬åˆå¹¶æˆå®ƒä»¬çš„æŒ‰ä½æˆ–ã€‚

å½¢å¼åŒ–åœ°ï¼Œä¸€æ¬¡æ“ä½œä¸­ï¼Œä½ é€‰æ‹©ä¸€ä¸ªä¸‹æ ‡ ð‘–*i*ï¼ˆ1â‰¤ð‘–<ð‘›1â‰¤*i*<*n*ï¼‰ï¼Œç„¶åŽæŠŠåŽŸåºåˆ—å˜æˆ$${a_1,a_2,â‹¯,a_iora_{i+1},a_{i+2},â‹¯,a_n}$$ã€‚

æ±‚ ð‘˜æ¬¡æ“ä½œåŽæ‰€æœ‰æ•°æŒ‰ä½ä¸Žçš„æœ€å¤§å€¼ã€‚

## é¢˜è§£

é¦–å…ˆæƒ³åˆ°æˆ‘ä»¬éœ€è¦ä¼˜å…ˆé€‰é«˜ä½ã€‚ä½†æ­¤æ—¶æ³¨æ„åˆ°ï¼Œå¯¹é«˜ä½çš„é€‰æ‹©ä¹Ÿä¼šå½±å“åˆ°ä½Žä½ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘ä¸€ä¸ªæ–¹å¼æ‰¾åˆ°ä¸€ä¸ªä¼˜çš„è§£ä½¿å¾—ç­”æ¡ˆæœ€å¤§

æ³¨æ„åˆ°åˆå¹¶çš„æ•°æœ¬èº«ä»£è¡¨äº†ä¸€ä¸ªåŒºé—´èŒƒå›´å†…çš„æ•°ï¼Œkæ¬¡æ“ä½œç›¸å½“äºŽé€‰å‡ºäº†n-kä¸ªåŒºé—´ï¼Œå¦‚æžœè¦æ±‚ç­”æ¡ˆä¸ºxåˆ™åŒºé—´å†…çš„æ•°å¹¶é›†ä¸ºxï¼Œæžšä¸¾æ¯ä¸€ä¸ªæ•°æ˜¾ç„¶æ˜¯ä¸çŽ°å®žçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒè¿›åˆ¶æžšä¸¾æ¥è¾¾åˆ°æ•ˆæžœã€‚

è¦è®°å¾—ä»Žé«˜åˆ°ä½Žæžšä¸¾ï¼Œå› ä¸ºæ¯æ¬¡è®°å½•tåˆ°ansä¸­ï¼Œæˆ‘ä»¬å®žé™…é™åˆ¶äº†åŽé¢çš„å–å€¼ã€‚

æˆ‘è§‰å¾—æ¯”å–æ¨¡é¢˜ç®€å•

```CPP
void slove() {
	cin>>n>>k;
	for(int i=1;i<=n;i++) cin>>a[i];

	int ans = 0;
	for(int i=29;~i;i--){
		int t = ans | (1<<i);

		int x = 0,cnt = 0;
		for(int i=1;i<=n;i++){
			x |= a[i];
			if((x & t) == t) cnt++,x=0;
		}
		if(cnt >= n - k) {
			ans = t;
			// cout<<cnt<<endl;
		}
	}

	cout<<ans<<endl;
}
```

## F. æ‹¬å·

https://www.luogu.com.cn/problem/P10513?contestId=174155

### é¢˜æ„

åœ†ç»™äº†ä½ ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸² $S$ï¼Œ$S$ ä»…ç”± ```(``` å’Œ ```)``` æž„æˆã€‚

å¥¹ä¼šå¯¹å…¶åš $m$ æ¬¡æ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç§ç±»åž‹ï¼š

1. ```1 l r```ï¼Œå¥¹ä¼šç¿»è½¬ $l$ åˆ° $r$ çš„æ‹¬å·ï¼Œå³ ```(``` å˜ ```)```ï¼Œ```)``` å˜ ```(```ã€‚
1. ```2 l r```ï¼Œå¥¹æƒ³çŸ¥é“åŒºé—´ $\left[ l,r\right]$ ä¸­æœ€é•¿åˆæ³•æ‹¬å·å­åºåˆ—çš„é•¿åº¦é™¤ä»¥ $2$ çš„ç­”æ¡ˆã€‚


åœ†è®¤ä¸ºä»¥ä¸‹çš„æ‹¬å·åºåˆ—æ˜¯åˆæ³•çš„ï¼š

1. ç©ºåºåˆ—æ˜¯ä¸€ä¸ªåˆæ³•åºåˆ—ã€‚

1. å¦‚æžœ ```A``` æ˜¯ä¸€ä¸ªåˆæ³•åºåˆ—ï¼Œåˆ™ ```(A)```  ä¹Ÿæ˜¯ä¸€ä¸ªåˆæ³•åºåˆ—ã€‚

1. å¦‚æžœ ```A``` å’Œ ```B``` éƒ½æ˜¯åˆæ³•åºåˆ—ï¼Œåˆ™ ```AB``` ä¹Ÿæ˜¯ä¸€ä¸ªåˆæ³•åºåˆ—ã€‚

åœ†è®¤ä¸ºï¼Œåºåˆ— $a$ çš„å­åºåˆ—æ˜¯æ»¡è¶³ $1\le i_1<i_2<Â·Â·Â·<i_k \le n$ çš„åºåˆ— $[a_{i_1},a_{i_2},...a_{i_k}]$ã€‚

ç”±äºŽæ“ä½œå¤ªå¤šäº†ï¼Œå¥¹ç®—ä¸è¿‡æ¥ï¼Œè¯·ä½ å¸®å¸®å¥¹å§ã€‚

### é¢˜è§£

æ´›è°·çœŸçš„è¦å“æ­»æˆ‘äº†ï¼Œç¬¬å…­é¢˜çº¿æ®µæ ‘

å¯¹æ•´ä¸ªå­ä¸²å»ºç«‹çº¿æ®µæ ‘ï¼ŒèŠ‚ç‚¹ä¸­ç»´æŠ¤å½“å‰åŒºé—´å·¦æ‹¬å·å’Œå³æ‹¬å·çš„çš„æ•°é‡ï¼Œåˆå¹¶å·¦å³èŠ‚ç‚¹å³

$$ans=å·¦è¾¹æ‹¬å·åºåˆ—+å³è¾¹æ‹¬å·åºåˆ—+æ¨ªè·¨ä¸­é—´çš„æ‹¬å·åºåˆ—$$

å¦‚ä½•ç»´æŠ¤äº¤æ¢è¿™ä¸€æ“ä½œå‘¢ï¼Ÿ

æˆ‘ä»¬å¯¹æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸¤ä¸ªä¸åŒçš„èŠ‚ç‚¹æ•°æ®ï¼Œä¸€ä¸ªæ˜¯çŽ°åœ¨çš„ï¼Œä¸€ä¸ªæ˜¯å‡è®¾ç¿»è½¬çš„ã€‚åœ¨äº¤æ¢æ—¶å°±äº¤æ¢è¿™ä¸¤ä¸ªæ•°æ®å³å¯ã€‚ï¼ˆä¹Ÿå¯ä»¥éƒ½æ‹†å¼€æˆä¸€ä¸ªä¸€ä¸ªå˜é‡ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ã€‚

```cpp
struct node {
	int l,r,ans;
	node(int x=0,int y=0,int z=0){l=x,r=y,ans=z;}
};
struct tree{int tag;node t1,t2;}t[N<<2];
char s[N];

node merge(node x,node y)
{
    int cnt=min(x.l,y.r);
    return {x.l+y.l-cnt,x.r+y.r-cnt,x.ans+y.ans+cnt};
}
inline void pushup(int p){t[p].t1=merge(t[ls].t1,t[rs].t1);t[p].t2=merge(t[ls].t2,t[rs].t2);}
inline void pushson(int p){swap(t[p].t1,t[p].t2);t[p].tag^=1;}
inline void pushdown(int p){if(!t[p].tag) return;pushson(ls),pushson(rs);t[p].tag=0;}
inline void build(int p,int l,int r)
{
    if(l==r) return t[p].t2.r=t[p].t1.l=(s[l]=='('),t[p].t2.l=t[p].t1.r=(s[l]==')'),void();
    build(ls,l,mid);build(rs,mid+1,r);pushup(p);
}
inline void modify(int p,int l,int r,int s,int e)
{
    if(l>=s&&r<=e) return pushson(p);pushdown(p);
    if(mid>=s) modify(ls,l,mid,s,e);if(mid<e) modify(rs,mid+1,r,s,e);
    pushup(p);
}
inline node query(int p,int l,int r,int s,int e)
{
    if(l>=s&&r<=e) return t[p].t1;pushdown(p);
    if(e<=mid) return query(ls,l,mid,s,e);
    if(s>mid) return query(rs,mid+1,r,s,e);
    return merge(query(ls,l,mid,s,e),query(rs,mid+1,r,s,e));
}

void slove() {
	cin>>n;
	cin>>s+1;
	build(1,1,n);
	cin>>m;
	while(m--){
		int op,l,r;cin>>op>>l>>r;
		if(op == 1) {
			modify(1,1,n,l,r);
		}else {
			cout<<query(1,1,n,l,r).ans<<endl;
		}
	}
}
```

## G.è€ƒè¯•

https://www.luogu.com.cn/problem/P10514?contestId=174155

### é¢˜æ„

æœ‰ $n$ ååŒå­¦åŽ»å‚åŠ è€ƒè¯•ï¼Œè€ƒè¯•æœ‰ $m$ é“é¢˜ã€‚

æ¯ä¸ªå­¦ç”Ÿçš„å®žåŠ›æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯æ¯é“é¢˜çš„éš¾åº¦å¯èƒ½ä¸åŒã€‚ç¬¬ $i$ é“é¢˜ä¼šæœ‰éšæœºçš„ $a_i$ ååŒå­¦åšé”™ã€‚

è€ƒè¯•ç»“æŸåŽï¼Œéšæœºé€‰å‡º $k$ ååŒå­¦ï¼Œæ±‚å‡ºè¿™äº›åŒå­¦å…¨éƒ¨åšå¯¹çš„æ¦‚çŽ‡ã€‚ç­”æ¡ˆå¯¹ $998244353$ å–æ¨¡ã€‚

### é¢˜è§£

æ•°å­¦é¢˜ã€‚ã€‚ã€‚ æ‡’å¾—æ‰“å…¬å¼äº†ï¼Œå¦‚ä¸‹

![image-20240527221944431](https://s2.loli.net/2024/05/27/6HONVPcKW8Ao75x.png)

é¢„å¤„ç†é˜¶ä¹˜ï¼Œå¿«é€Ÿå¹‚åˆ†æ¯æ—¶é—´å¤æ‚åº¦ä¸ºlog(m)+n

å¤„ç†åˆ†å­æ—¶é—´å¤æ‚åº¦ä¸ºmlog(n)

```cpp
ll qmi(ll a,ll b,ll mod = MOD){
	ll res = 1;
	for(;b;b>>=1){
		if(b&1) res = res * a % mod;
		a = a * a % mod;
	}
	return res;
}

void init(){
	fac[0] = infac[0] = 1;
	for(int i=1;i<N;i++){
		fac[i] = fac[i-1] *i % MOD;
		infac[i] = infac[i-1] * qmi(i,MOD-2,MOD) % MOD;
		// cout<<fac[i]<<' ' <<infac[i]<<endl;
	}
}

void slove() {
	cin>>n>>m>>k;

	int mx = 0;
	for(int i=1;i<=m;i++) cin>>a[i], mx= max(mx,a[i]);

	if(mx + k > n) {cout<<0<<endl;return ;}

	int inv = qmi(qmi(fac[n] % MOD * infac[n-k] %MOD, m, MOD),MOD-2,MOD);

	int factor = 1;
	for(int i=1;i<=m;i++){
		factor = factor * fac[n-a[i]] % MOD * infac[n-k-a[i]] % MOD;
	}

	cout<<factor*inv % MOD<<endl;
}
```

## H. è½¬åœˆã€æŒ‰é’®P4861

https://www.luogu.com.cn/problem/P10515?contestId=174155

### é¢˜æ„

å° $\delta$ å–œæ¬¢è½¬åœˆåœˆã€‚

ä»–æœ‰ä¸€ä¸ªåœˆï¼Œè¢«å‡åŒ€åˆ†æˆäº† $n$ ä¸ªæ ¼å­ï¼Œç¥žå¥‡çš„æ˜¯ï¼Œ$n$ æ˜¯ä¸€ä¸ªè´¨æ•°ã€‚ç¬¬ $i$ ä¸ªæ ¼å­ä¸Šå†™ç€ä¸€ä¸ªæ•° $i \times m$ï¼Œä»–çŽ°åœ¨ç«™åœ¨ç¬¬ä¸€ä¸ªæ ¼å­ä¸Šã€‚

æŽ¥ä¸‹æ¥ä»–ä¼šçœ‹çœ‹è„šä¸‹è¸©ç€çš„æ•°æ˜¯å¤šå°‘ï¼Œç„¶åŽå‘å‰èµ°è¿™ä¹ˆå¤šæ ¼ã€‚ä»–ä¼šä¸€ç›´åå¤è¿™ä¹ˆåšã€‚

æ±‚æœ€ç»ˆè¢«å° $\delta$ è¸©åˆ°è¿‡çš„æ ¼å­çš„æ•°é‡ã€‚ç”±äºŽå° $\delta$ æœ‰å¾ˆå¤šåœˆåœˆï¼Œæ‰€ä»¥ä»–ä¼šé—®ä½ å¾ˆå¤šæ¬¡ã€‚

### é¢˜è§£

è¿™é¢˜å’ŒP4861æ’žäº†ï¼Œæ‰€ä»¥æˆ‘å¹²è„†è´´è¿™é¢˜äº†

æ ¹æ®æ¬§æ‹‰å®šç†$$a^{\phi(p)}= 1 (modp)$$

å› æ­¤$$\phi(p)$$ä¸€å®šæ˜¯ç­”æ¡ˆçš„å€æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦æžšä¸¾å®ƒçš„å› å­å³å¯

```cpp
ll qmi(ll a,ll b,ll mod = MOD){
	ll res = 1;
	for(;b;b>>=1){
		if(b&1) res = res * a % mod;
		a = a * a % mod;
	}
	return res;
}
int gcd(int x,int y){return y? gcd(y,x%y): x;}

void init(){}

int get_phi(int x){
	int res = x;
	if(!(x&1)) res >>= 1;

	for(int i=3;i*i<=x; i+= 2){
		if(x % i == 0){
			res -= res /i;
			while(x % i == 0) x/=i;
		}
	}
	if(x > 1) res -= res / x;

	return res;
}

void slove() {
	cin>>n>>m;
	if(gcd(n,m)!=1)puts("Let's go Blue Jays!");//æ— è§£
    else{
        int p=get_phi(n);//å¾—åˆ°phi
        int mm=p;
        int tot = 0;
        for(int i=2;(i*i)<=mm;i++){
            if(mm%i)continue;
            pri[++tot]=i;
            while(mm%i==0){
                mm/=i;
                tim[tot]++;
            }
        }
        if(mm!=1){
            pri[++tot]=mm;
            tim[tot]=1;
        }

        int ss=1,qq=p;
        while(ss<=tot){
            for(int i=1;i<=tim[ss];i++){
                if(qmi(m,qq/pri[ss],n)==1)qq/=pri[ss];
                else break;
            }
            ss++;
        }
        cout<<qq<<endl;
    }
}
```
