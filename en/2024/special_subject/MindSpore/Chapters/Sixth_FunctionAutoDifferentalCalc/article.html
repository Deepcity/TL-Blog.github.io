<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="EzvkH8RisfPPs4FDg8TcP3u6FtkMev8TBOJLPE7OEN4">
  <meta name="msvalidate.01" content="80DCDC7CC1EB61C078DE11A21469B857">
  <meta name="baidu-site-verification" content="codeva-zBnxVrCEgy">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=ä»¿å®‹:300,300italic,400,400italic,700,700italic%7CLobster+Two:300,300italic,400,400italic,700,700italic%7Cfira+code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"deepcity.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":true,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ† ç¥ç»ç½‘ç»œçš„è®­ç»ƒä¸»è¦ä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•ï¼Œæ¨¡å‹é¢„æµ‹å€¼ï¼ˆlogitsï¼‰ä¸æ­£ç¡®æ ‡ç­¾ï¼ˆlabelï¼‰é€å…¥æŸå¤±å‡½æ•°ï¼ˆloss functionï¼‰è·å¾—lossï¼Œç„¶åè¿›è¡Œåå‘ä¼ æ’­è®¡ç®—ï¼Œæ±‚å¾—æ¢¯åº¦ï¼ˆgradientsï¼‰ï¼Œæœ€ç»ˆæ›´æ–°è‡³æ¨¡å‹å‚æ•°ï¼ˆparametersï¼‰ã€‚è‡ªåŠ¨å¾®åˆ†èƒ½å¤Ÿè®¡ç®—å¯å¯¼å‡½æ•°åœ¨æŸç‚¹å¤„çš„å¯¼æ•°å€¼ï¼Œæ˜¯åå‘ä¼ æ’­ç®—æ³•çš„ä¸€èˆ¬åŒ–ã€‚è‡ªåŠ¨å¾®åˆ†ä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯å°†ä¸€ä¸ªå¤æ‚çš„æ•°å­¦è¿ç®—åˆ†è§£ä¸ºä¸€ç³»åˆ—ç®€å•çš„åŸºæœ¬è¿ç®—ï¼Œè¯¥åŠŸèƒ½">
<meta property="og:type" content="article">
<meta property="og:title" content="MindSporeä¸“é¢˜â€”â€”ç¬¬å…­ç« â€”â€”å‡½æ•°å¼å¾®åˆ†">
<meta property="og:url" content="https://deepcity.github.io/en/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html">
<meta property="og:site_name" content="ThreeLanes&#39; Site">
<meta property="og:description" content="å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ† ç¥ç»ç½‘ç»œçš„è®­ç»ƒä¸»è¦ä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•ï¼Œæ¨¡å‹é¢„æµ‹å€¼ï¼ˆlogitsï¼‰ä¸æ­£ç¡®æ ‡ç­¾ï¼ˆlabelï¼‰é€å…¥æŸå¤±å‡½æ•°ï¼ˆloss functionï¼‰è·å¾—lossï¼Œç„¶åè¿›è¡Œåå‘ä¼ æ’­è®¡ç®—ï¼Œæ±‚å¾—æ¢¯åº¦ï¼ˆgradientsï¼‰ï¼Œæœ€ç»ˆæ›´æ–°è‡³æ¨¡å‹å‚æ•°ï¼ˆparametersï¼‰ã€‚è‡ªåŠ¨å¾®åˆ†èƒ½å¤Ÿè®¡ç®—å¯å¯¼å‡½æ•°åœ¨æŸç‚¹å¤„çš„å¯¼æ•°å€¼ï¼Œæ˜¯åå‘ä¼ æ’­ç®—æ³•çš„ä¸€èˆ¬åŒ–ã€‚è‡ªåŠ¨å¾®åˆ†ä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯å°†ä¸€ä¸ªå¤æ‚çš„æ•°å­¦è¿ç®—åˆ†è§£ä¸ºä¸€ç³»åˆ—ç®€å•çš„åŸºæœ¬è¿ç®—ï¼Œè¯¥åŠŸèƒ½">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2024/06/07/MLN1Ap2wslU4SQB.jpg">
<meta property="og:image" content="https://deepcity.github.io/en/AppData/Roaming/Typora/typora-user-images/image-20240607181215798.png">
<meta property="og:image" content="https://s2.loli.net/2024/06/07/SJ5Rf7m6cXFs8yN.png">
<meta property="og:image" content="https://s2.loli.net/2024/06/07/iqHnjI12DSKR6P7.png">
<meta property="og:image" content="https://s2.loli.net/2024/06/07/MAOZxqKodRSW6uy.jpg">
<meta property="og:image" content="https://s2.loli.net/2024/06/07/XvLsuFKjBe39AaD.png">
<meta property="og:image" content="https://wikimedia.org/api/rest_v1/media/math/render/svg/a9702eeec5a8eb416883af66665ac11bd8151f0f">
<meta property="article:published_time" content="2024-08-14T11:47:58.000Z">
<meta property="article:modified_time" content="2024-08-16T08:59:11.000Z">
<meta property="article:author" content="ThreeLanes">
<meta property="article:tag" content="æœºå™¨å­¦ä¹ ">
<meta property="article:tag" content="MindSpore">
<meta property="article:tag" content="ç›®å½•">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2024/06/07/MLN1Ap2wslU4SQB.jpg">


<link rel="canonical" href="https://deepcity.github.io/en/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://deepcity.github.io/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html","path":"en/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html","title":"MindSporeä¸“é¢˜â€”â€”ç¬¬å…­ç« â€”â€”å‡½æ•°å¼å¾®åˆ†"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MindSporeä¸“é¢˜â€”â€”ç¬¬å…­ç« â€”â€”å‡½æ•°å¼å¾®åˆ† | ThreeLanes' Site</title>
  







<link rel="dns-prefetch" href="https://vercel.keboe.cn/">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="ThreeLanes' Site" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ThreeLanes' Site</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å…±äº« å¼€æ”¾ åŒ…å®¹ æ”¹è¿›</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Calendar</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li><li class="menu-item menu-item-monitor"><span class="exturl" data-url="aHR0cHM6Ly91cHRpbWUua2Vib2UuY24vc3RhdHVzL3Rlc3Q="><i class="fa fa-computer fa-fw"></i>ç›‘æ§å™¨</span></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86"><span class="nav-number">1.</span> <span class="nav-text">å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%88%B0%E5%BA%95%E4%BB%A3%E8%A1%A8%E4%BA%86%E4%BB%80%E4%B9%88"><span class="nav-number">2.</span> <span class="nav-text">ç¥ç»ç½‘ç»œåˆ°åº•ä»£è¡¨äº†ä»€ä¹ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cost-Function%EF%BC%88Maybe-also-loss-function-%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">Cost Functionï¼ˆMaybe also loss function?ï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D-Gradient-Descent"><span class="nav-number">3.1.</span> <span class="nav-text">æ¢¯åº¦ä¸‹é™ (Gradient Descent)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"><span class="nav-number">4.</span> <span class="nav-text">åå‘ä¼ æ’­</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mini-batches"><span class="nav-number">5.</span> <span class="nav-text">Mini-batches</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Backpropagation"><span class="nav-number">6.</span> <span class="nav-text">Backpropagation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E4%B8%8E%E8%AE%A1%E7%AE%97%E5%9B%BE"><span class="nav-number">7.</span> <span class="nav-text">å‡½æ•°ä¸è®¡ç®—å›¾</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AE%E5%88%86%E5%87%BD%E6%95%B0%E4%B8%8E%E6%A2%AF%E5%BA%A6%E8%AE%A1%E7%AE%97"><span class="nav-number">8.</span> <span class="nav-text">å¾®åˆ†å‡½æ•°ä¸æ¢¯åº¦è®¡ç®—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Stop-Gradient"><span class="nav-number">8.1.</span> <span class="nav-text">Stop Gradient</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Auxiliary-data"><span class="nav-number">8.2.</span> <span class="nav-text">Auxiliary data</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%A2%AF%E5%BA%A6%E8%AE%A1%E7%AE%97"><span class="nav-number">8.3.</span> <span class="nav-text">ç¥ç»ç½‘ç»œæ¢¯åº¦è®¡ç®—</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%E8%BE%93%E5%87%BA%EF%BC%88%E5%8D%95%E6%AC%A1%EF%BC%89"><span class="nav-number">8.4.</span> <span class="nav-text">æ€»ç»“è¾“å‡ºï¼ˆå•æ¬¡ï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E5%80%BC%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1"><span class="nav-number">9.</span> <span class="nav-text">äºŒå€¼äº¤å‰ç†µæŸå¤±</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E7%86%B5%E6%9D%A5%E7%9C%8B%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1"><span class="nav-number">9.1.</span> <span class="nav-text">ä»ç†µæ¥çœ‹äº¤å‰ç†µæŸå¤±</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E9%87%8F"><span class="nav-number">9.1.1.</span> <span class="nav-text">ä¿¡æ¯é‡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%86%B5"><span class="nav-number">9.1.2.</span> <span class="nav-text">ç†µ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B8%E5%AF%B9%E7%86%B5-%EF%BC%88Relative-entropy%EF%BC%89-KL%E6%95%A3%E5%BA%A6"><span class="nav-number">9.1.3.</span> <span class="nav-text">ç›¸å¯¹ç†µ ï¼ˆRelative entropyï¼‰&#x2F;  KLæ•£åº¦</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%A4%E5%8F%89%E7%86%B5-Cross-Entropy"><span class="nav-number">9.1.4.</span> <span class="nav-text">äº¤å‰ç†µ Cross Entropy</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E4%BA%A4%E5%8F%89%E7%86%B5%E5%81%9Aloss%E5%87%BD%E6%95%B0"><span class="nav-number">9.2.</span> <span class="nav-text">ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰ç†µåšlosså‡½æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E5%8F%89%E7%86%B5%E5%9C%A8%E5%8D%95%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">9.3.</span> <span class="nav-text">äº¤å‰ç†µåœ¨å•åˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E5%8F%89%E7%86%B5%E5%9C%A8%E5%A4%9A%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">9.4.</span> <span class="nav-text">äº¤å‰ç†µåœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E7%9C%8B%E4%BA%A4%E5%8F%89%E7%86%B5"><span class="nav-number">9.5.</span> <span class="nav-text">ä»æœ€å¤§ä¼¼ç„¶çœ‹äº¤å‰ç†µ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%92%8C%E7%9B%B8%E5%AF%B9%E7%86%B5%E7%AD%89%E4%BB%B7"><span class="nav-number">9.5.1.</span> <span class="nav-text">å’Œç›¸å¯¹ç†µç­‰ä»·</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%92%8C%E4%BA%A4%E5%8F%89%E7%86%B5%E7%AD%89%E4%BB%B7"><span class="nav-number">9.5.2.</span> <span class="nav-text">å’Œäº¤å‰ç†µç­‰ä»·</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%88%86%E7%B1%BB%E4%BA%A4%E5%8F%89%E7%86%B5"><span class="nav-number">9.6.</span> <span class="nav-text">å¤šåˆ†ç±»äº¤å‰ç†µ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Cross-Entropy-Loss"><span class="nav-number">9.6.1.</span> <span class="nav-text">Cross Entropy Loss</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PyTorch%E4%B8%AD%E7%9A%84Cross-Entropy"><span class="nav-number">9.6.2.</span> <span class="nav-text">PyTorchä¸­çš„Cross Entropy</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%88%86%E7%B1%BB%E4%BA%A4%E5%8F%89%E7%86%B5"><span class="nav-number">9.7.</span> <span class="nav-text">äºŒåˆ†ç±»äº¤å‰ç†µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">9.8.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98"><span class="nav-number">10.</span> <span class="nav-text">å›å½’é—®é¢˜</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1"><span class="nav-number">11.</span> <span class="nav-text">æœ€å¤§ä¼¼ç„¶ä¼°è®¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">11.1.</span> <span class="nav-text">åŸç†</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ThreeLanes</p>
  <div class="site-description" itemprop="description">è¿™æ˜¯ä¸€ä¸ªä¸ªäººblogç«™ç‚¹ï¼Œè®°å½•æŠ€æœ¯ä¸çŸ¥è¯†æ–‡ç« </div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RlZXBjaXR5" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Deepcity"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmYxMTU5NDcyODk5QDE2My5jb20=" title="E-Mail â†’ mailto:f1159472899@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly94LmNvbS9EZWVwQ2l0eTc2NDYzNw==" title="Twitter â†’ https:&#x2F;&#x2F;x.com&#x2F;DeepCity764637"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="c2t5cGU6R2FuZyBTdW4/Y2FsbHxjaGF0" title="Skype â†’ skype:Gang Sun?call|chat"><i class="fab fa-skype fa-fw"></i>Skype</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmtlYm9lLmNuL2ltYWdlcy9xcS1jb250YWN0LnBuZw==" title="QQ â†’ https:&#x2F;&#x2F;blog.keboe.cn&#x2F;images&#x2F;qq-contact.png"><i class="fab fa-qq fa-fw"></i>QQ</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://deepcity.github.io/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ThreeLanes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ThreeLanes' Site">
      <meta itemprop="description" content="è¿™æ˜¯ä¸€ä¸ªä¸ªäººblogç«™ç‚¹ï¼Œè®°å½•æŠ€æœ¯ä¸çŸ¥è¯†æ–‡ç« ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MindSporeä¸“é¢˜â€”â€”ç¬¬å…­ç« â€”â€”å‡½æ•°å¼å¾®åˆ† | ThreeLanes' Site">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MindSporeä¸“é¢˜â€”â€”ç¬¬å…­ç« â€”â€”å‡½æ•°å¼å¾®åˆ†<span class="exturl post-edit-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RlZXBjaXR5L2RlZXBjaXR5LmdpdGh1Yi5pby90cmVlL21haW4vc291cmNlL19wb3N0cy9zcGVjaWFsX3N1YmplY3QvTWluZFNwb3JlL0NoYXB0ZXJzL1NpeHRoX0Z1bmN0aW9uQXV0b0RpZmZlcmVudGFsQ2FsYy5tZA==" title="Edit this post"><i class="fa fa-pen-nib"></i></span>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-08-14 19:47:58" itemprop="dateCreated datePublished" datetime="2024-08-14T19:47:58+08:00">2024-08-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-16 16:59:11" itemprop="dateModified" datetime="2024-08-16T16:59:11+08:00">2024-08-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%B8%93%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">ä¸“é¢˜</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%B8%93%E9%A2%98/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æœºå™¨å­¦ä¹ </span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%B8%93%E9%A2%98/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Mindspore/" itemprop="url" rel="index"><span itemprop="name">Mindspore</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%B8%93%E9%A2%98/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Mindspore/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" itemprop="url" rel="index"><span itemprop="name">åŸºæœ¬æ¦‚å¿µ</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline: </span>
  
    <a title="waline" href="/en/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/en/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>8.4k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>30 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†"><a href="#å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†" class="headerlink" title="å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†"></a>å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†</h2><blockquote>
<p>ç¥ç»ç½‘ç»œçš„è®­ç»ƒä¸»è¦ä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•ï¼Œæ¨¡å‹é¢„æµ‹å€¼ï¼ˆlogitsï¼‰ä¸æ­£ç¡®æ ‡ç­¾ï¼ˆlabelï¼‰é€å…¥æŸå¤±å‡½æ•°ï¼ˆloss functionï¼‰è·å¾—lossï¼Œç„¶åè¿›è¡Œåå‘ä¼ æ’­è®¡ç®—ï¼Œæ±‚å¾—æ¢¯åº¦ï¼ˆgradientsï¼‰ï¼Œæœ€ç»ˆæ›´æ–°è‡³æ¨¡å‹å‚æ•°ï¼ˆparametersï¼‰ã€‚è‡ªåŠ¨å¾®åˆ†èƒ½å¤Ÿè®¡ç®—å¯å¯¼å‡½æ•°åœ¨æŸç‚¹å¤„çš„å¯¼æ•°å€¼ï¼Œæ˜¯åå‘ä¼ æ’­ç®—æ³•çš„ä¸€èˆ¬åŒ–ã€‚è‡ªåŠ¨å¾®åˆ†ä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯å°†ä¸€ä¸ªå¤æ‚çš„æ•°å­¦è¿ç®—åˆ†è§£ä¸ºä¸€ç³»åˆ—ç®€å•çš„åŸºæœ¬è¿ç®—ï¼Œè¯¥åŠŸèƒ½å¯¹ç”¨æˆ·å±è”½äº†å¤§é‡çš„æ±‚å¯¼ç»†èŠ‚å’Œè¿‡ç¨‹ï¼Œå¤§å¤§é™ä½äº†æ¡†æ¶çš„ä½¿ç”¨é—¨æ§›ã€‚</p>
</blockquote>
<span id="more"></span>
<blockquote>
<p>MindSporeä½¿ç”¨å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†çš„è®¾è®¡ç†å¿µï¼Œæä¾›æ›´æ¥è¿‘äºæ•°å­¦è¯­ä¹‰çš„è‡ªåŠ¨å¾®åˆ†æ¥å£<code>grad</code>å’Œ<code>value_and_grad</code>ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å•å±‚çº¿æ€§å˜æ¢æ¨¡å‹è¿›è¡Œä»‹ç»ã€‚</p>
</blockquote>
<p>è¿™é‡Œæ€»ç®—æ˜¯æåˆ°äº†åå‘ä¼ æ’­ï¼Œæœ€è¿‘æˆ‘çœ‹åˆ°äº†ä¸€ç³»åˆ—è§†é¢‘æœ‰å…³Machine Learningï¼Œä¼ é€é—¨å¦‚ä¸‹ï¼š</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1JbGczZ0dld1E1VQ==">ğŸ”´ World of Warships / USS Des Moines cut (youtube.com)<i class="fa fa-external-link-alt"></i></span></p>
<p>å¦‚æœä½ è¯•å›¾çœ‹ä¸‹å»çš„è¯ï¼Œå¯èƒ½ä¼šå‘ç°ï¼Œäº‹æƒ…å¥½åƒçªç„¶å˜éš¾äº†ï¼Œä¼¼ä¹ä¸€ç¾¤ä»æœªè§è¿‡çš„çŸ¥è¯†ç»„åˆåœ¨äº†ä¸€èµ·ï¼Œç¥ç»ç½‘ç»œå°±åƒä¸€ä¸ªé»‘ç®±è¿ç€å¦ä¸€ä¸ªé»‘ç®±ï¼Œè€Œä½ æ ¹æœ¬ä¸çŸ¥é“å¦‚ä½•ä¼˜åŒ–å®ƒï¼Œä½¿å¾—é»‘ç®±åœ¨ç»™å®šçš„è¾“å…¥ä¸‹è¾“å‡ºæ­£ç¡®ç­”æ¡ˆ</p>
<h2 id="ç¥ç»ç½‘ç»œåˆ°åº•ä»£è¡¨äº†ä»€ä¹ˆ"><a href="#ç¥ç»ç½‘ç»œåˆ°åº•ä»£è¡¨äº†ä»€ä¹ˆ" class="headerlink" title="ç¥ç»ç½‘ç»œåˆ°åº•ä»£è¡¨äº†ä»€ä¹ˆ"></a>ç¥ç»ç½‘ç»œåˆ°åº•ä»£è¡¨äº†ä»€ä¹ˆ</h2><p>é¦–å…ˆè®©æˆ‘ä»¬å®šä¹‰ä»€ä¹ˆæ˜¯ç¥ç»ï¼šä»–æ˜¯ä¸€ä¸ªæºå¸¦ä¸€ä¸ªæµ®ç‚¹æ•°çš„ç»“æ„ï¼Œç„¶åè®©æˆ‘ä»¬çœ‹å‘ç¥ç»ç½‘ç»œ</p>
<p><img src="https://s2.loli.net/2024/06/07/MLN1Ap2wslU4SQB.jpg" alt="R"></p>
<p>å¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬ä»æœ€åçœ‹èµ·ï¼Œæ˜¾ç„¶ï¼Œä»–ä»¬ä»£è¡¨0-9ï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œä»–ä»¬ä»£è¡¨0-9çš„å›¾åƒã€‚ä¸ºä»€ä¹ˆè¿™æ ·çš„ç½‘ç»œæ˜¯ç”Ÿæ•ˆçš„å‘¢ï¼Ÿ</p>
<p><strong><em>å› ä¸ºåˆ†å½¢æ€æƒ³</em></strong>ï¼Œæˆ‘ä»¬å°†ä¸€æ®µè¿ç»­çš„å›¾åƒåŒºåˆ†ä¸ºä¸€æ®µä¸€æ®µï¼Œæ¯”å¦‚9æ˜¯âšªåœ¨ä¸Šè€Œçº¿æ¡åœ¨ä¸‹ã€‚4ç”±å¤šç«¯çº¿æ®µ1ç»„æˆã€‚è€Œâšªå’Œçº¿æ¡åˆå¯ä»¥ç»§ç»­å†åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¥ç»ç½‘ç»œä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ä»£è¡¨çš„æ•°æ®æƒ³è±¡æˆè¿™ç§è§„å¾‹å›¾æ¡ˆçš„é›†åˆã€‚ä»–ä»¬ä¹‹é—´çš„ä¼ é€’å°±æ˜¯å›¾æ¡ˆåœ¨ç½‘ç»œä¸­ä¸æ–­ç»„åˆã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ç½‘ç»œä¸­ä½¿ç”¨å…¨è¿æ¥çš„åŸå› ï¼Œå› ä¸ºæ¯ä¸€ä¸ªå›¾æ¡ˆéƒ½èƒ½ä¸å…¶ä»–ä»»ä½•å›¾æ¡ˆç»„åˆã€‚æœ€ç»ˆæˆ‘ä»¬ä½¿å›¾æ¡ˆå˜æˆäº†ä¸æ–­åˆ†å½¢åƒç´ çš„ç»„åˆã€‚</p>
<p>ä½†å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ è€ƒè™‘æˆ‘ä»¬å‰é¢æåˆ°çš„å‚æ•°ï¼Œæƒå€¼ã€‚</p>
<p><img src="./../../../../../AppData/Roaming/Typora/typora-user-images/image-20240607181215798.png" alt="image-20240607181215798"></p>
<p>è¿™å¼ å›¾ç›¸ä¿¡æœ‰å¾ˆå¤šäººè§è¿‡ç±»ä¼¼çš„å›¾ï¼Œå®é™…ä¸Šæƒå€¼ä»£è¡¨çš„å°±æ˜¯ç¥ç»ç½‘ç»œä¹‹é—´çš„è¿çº¿ï¼Œå‡è®¾æˆ‘ä»¬è®©æ­£æƒå€¼åœ¨ä¸‹è¡¨ä¸­ä¸ºç»¿è´Ÿæƒå€¼åœ¨ä¸‹è¡¨ä¸­ä¸ºçº¢ï¼Œæˆ‘ä»¬å°†è¿™æ ·æè¿°ä¸€æ¡â€œçº¿æ®µâ€ï¼šä¸€æ®µç”±çº¢è‰²åŒ…å›´çš„é•¿æ¡çŠ¶ç»¿è‰²åŒºåŸŸè¿™æ ·æˆ‘ä»¬å°±èƒ½å¾—å‡ºï¼Œå¦‚æœè¿™æ®µçº¿æ¡æ˜¯æˆç«‹å¾—è¯ï¼Œæ¯”å¦‚ç¡®å®åŸå›¾è¿™é‡Œå­˜åœ¨ä¸€æ¡çº¿æ®µï¼Œæˆ‘ä»¬å¾—åˆ°çš„è¿™ä¸ªç¥ç»èŠ‚ç‚¹ä¸Šå¾—å€¼å°±ä¼šå¾ˆæ¥è¿‘1ï¼Œå¦åˆ™å°±ä¼šå¾ˆæ¥è¿‘é›¶ã€‚è¿™å°±æ˜¯æƒå€¼å¾—æ„ä¹‰ã€‚ä½†åŒæ—¶ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°ç¥ç»å¾—å€¼æ˜¯è®¸å¤šè¿™æ ·è®¡ç®—çš„ç´¯å’Œï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªbiasï¼Œåå·®å€¼å°†å…¶è®¡ç®—åˆ°åˆ°0-1ã€‚</p>
<p>æ³¨æ„è¿™é‡Œå¾—æƒå€¼å’Œåå·®å€¼å‡æ˜¯å˜é‡ï¼Œæ˜¯è®­ç»ƒå‡ºæ¥çš„ã€‚å¹¶ä¸”æ³¨æ„ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“æœºå™¨æ˜¯å¦‚ä½•åˆ†å½¢å¾—ï¼Œè¿™å–å†³äºå­¦ä¹ æ•°æ®å’Œä½¿ç”¨çš„ç®—æ³•ï¼Œä»¥ä¸Šåªä¸ºä¸¾ä¾‹ç†è§£ã€‚</p>
<p>å¦‚æœå°†æœ€åˆå¾—ç¥ç»ç½‘ç»œæ‹¿å»ä½¿ç”¨ï¼Œä½ åªä¼šå¾—åˆ°ä¸€å¤§å †åƒåœ¾æ•°æ®ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ç¥ç»ç½‘ç»œå­˜åœ¨â€œè¿›åŒ–â€è¿‡ç¨‹ï¼Œä½†ä»–æ˜¯å¦‚ä½•çŸ¥é“è‡ªå·±é”™å¾—æœ‰å¤šç¦»è°±çš„å‘¢ï¼Ÿ</p>
<h2 id="Cost-Functionï¼ˆMaybe-also-loss-function-ï¼‰"><a href="#Cost-Functionï¼ˆMaybe-also-loss-function-ï¼‰" class="headerlink" title="Cost Functionï¼ˆMaybe also loss function?ï¼‰"></a>Cost Functionï¼ˆMaybe also loss function?ï¼‰</h2><p>åˆç•¥çš„å®šä¹‰æ˜¯ä»–æ˜¯è¾“å‡ºçš„å¼ é‡ä¸æ­£ç¡®çš„å¼ é‡çš„å·®å€¼å¹³æ–¹å’Œï¼Œæ¯”å¦‚ï¼Œæœºå™¨è¾“å‡ºäº†ä¸€ä¸ªå…¨æ˜¯0.5çš„10ä¸ªæ•°çš„å¼ é‡ï¼Œè€Œæ­£ç¡®ç­”æ¡ˆæ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œé‚£ä¹ˆ</p>
<script type="math/tex; mode=display">
\text{Cost} = (1-0.5) + 0.5*9</script><p>æ˜¾ç„¶è¿™ä¸ªæ•°å­—æ›´æ¥è¿‘0ï¼Œè¯´æ˜ç»“æœæ›´åŠ å‡†ç¡®</p>
<p>è€ƒè™‘å¦‚ä½•è®©æ¨¡å‹è¡¨ç°å¾—æ›´å¥½ï¼Œæ˜¾ç„¶æ˜¯éœ€è¦æ‰¾åˆ°ä¸€ç»„å‚æ•°ï¼Œä½¿å¾—æ¯æ¬¡è¾“å‡ºçš„costå€¼æœ€å°ã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘è¿™æ ·ä¸€ç§æ–¹å¼ï¼Œä»¥å‚æ•°ä½œä¸ºè¾“å…¥ï¼Œcostçš„å€¼ä½œä¸ºè¾“å‡ºï¼Œè€Œè®­ç»ƒæ•°æ®åˆ™æ˜¯å‚æ•°ã€‚</p>
<h3 id="æ¢¯åº¦ä¸‹é™-Gradient-Descent"><a href="#æ¢¯åº¦ä¸‹é™-Gradient-Descent" class="headerlink" title="æ¢¯åº¦ä¸‹é™ (Gradient Descent)"></a>æ¢¯åº¦ä¸‹é™ (Gradient Descent)</h3><p>ä¼¼ä¹éš¾ä»¥ç†è§£ï¼Œå‡è®¾æˆ‘ä»¬åªæœ‰ä¸€ä¸ªå‚æ•°cost=f(c)ï¼Œcæ˜¯å”¯ä¸€çš„å‚æ•°ã€‚äºæ˜¯å˜ä¸ºäº†å‡½æ•°çš„æœ€å€¼é—®é¢˜ï¼Œåªéœ€è¦æ±‚å¯¼æ•°ç„¶åæ…¢æ…¢ç§»åŠ¨æˆ‘ä»¬çš„åˆå§‹ç‚¹ã€‚å¾ˆæ˜¾ç„¶ï¼Œä¸€ä¸ªå‡½æ•°åœ¨å¸¸æ•°åŸŸä¸Šå¯èƒ½å­˜åœ¨å¤šä¸ªæå¤§å€¼è€Œåªæœ‰ä¸€ä¸ªæœ€å¤§å€¼ã€‚å½“æˆ‘ä»¬ä»ä¸€ä¸ªç‚¹å‡ºå‘å¯»æ‰¾æœ€å¤§å€¼æ—¶ï¼Œå¾ˆæœ‰å¯èƒ½ï¼ˆæ¦‚ç‡å­¦ä¸Šè®²åº”è¯¥æ˜¯ç»å¯¹ï¼‰æˆ‘ä»¬åªä¼šæ‰¾åˆ°ä¸€ä¸ªæå¤§å€¼ã€‚å³åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯æˆ‘ä»¬çš„å‚æ•°æ˜¯æœ€ä¼˜çš„ï¼Œåªèƒ½ä¿è¯æˆ‘ä»¬çš„å‚æ•°æ˜¯å±€éƒ¨æœ€ä¼˜çš„ï¼ˆè¿™å–å†³äºæˆ‘ä»¬çš„èµ·å§‹ç‚¹ï¼‰ã€‚</p>
<p>å˜åˆ°å¤šç»´ï¼Œæˆ‘ä»¬æ„è¯†åˆ°ï¼Œä¸€ä¸ªæ•°çš„å¯¼æ•°æ˜¯å¦åªæœ‰æ­£æˆ–è´Ÿä¸¤ç§ä¿¡æ¯æœ‰æ•ˆï¼ˆä»£è¡¨æ˜¯åº”è¯¥å¢åŠ è¿™ä¸ªæ•°è¿˜æ˜¯å‡å°‘è¿™ä¸ªæ•°ï¼‰ã€‚å‡å®šä¸¤ä¸ªå˜é‡åœ¨ä¸€ä¸ªç‚¹ä¸Šçš„å¯¼æ•°å…¶ä¸­ä¸€ä¸ªæ˜¯å¦ä¸€ä¸ªçš„ä¸‰å€ï¼Œè¿™è‡³å°‘è¯´æ˜åœ¨è¯¥ç‚¹çš„é‚»åŸŸå†…ï¼Œè¿™ä¸€å˜é‡åº”è¯¥å‡å°‘çš„æ›´å¤šæ˜¯æ­£ç¡®çš„ã€‚ï¼ˆå¯èƒ½æœ‰ä¸€äº›å‡½æ•°å­˜åœ¨æç«¯çš„å°–ç‚¹å¯¼è‡´é”™è¯¯ï¼Œä½†è¿™åœ¨ç¥ç»ç½‘ç»œä¸­æ˜¯ä½æ¦‚ç‡çš„ï¼ŒæŒæ§å¥½æ›´æ”¹æ•°æ®çš„å¤§å°å³å¯ï¼‰ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­æ˜¯ï¼Œç»´æŠ¤å¥½ä¸€ä¸ª<script type="math/tex">\nabla C</script>çŸ©é˜µï¼Œä¸€é˜¶å¯¼æ•°å¯¹åº”çš„å€¼é«˜åˆ™å…¶å¢åŠ ï¼Œåä¹‹åˆ™å‡å°‘ã€‚</p>
<h2 id="åå‘ä¼ æ’­"><a href="#åå‘ä¼ æ’­" class="headerlink" title="åå‘ä¼ æ’­"></a>åå‘ä¼ æ’­</h2><p>ä»ç‰¹æ®Šåˆ°ä¸€èˆ¬ï¼Œæˆ‘ä»¬å…ˆè§‚å¯Ÿè¿™æ ·ä¸€ä¸ªæ ·ä¾‹</p>
<p><img src="https://s2.loli.net/2024/06/07/SJ5Rf7m6cXFs8yN.png" alt="image-20240607205110764"></p>
<p>æ˜¾ç„¶æˆ‘ä»¬éœ€è¦å¢åŠ 2ï¼Œå¹¶ä¸”å¦‚æœç»™æˆ‘ä»¬è¦åšçš„äº‹æƒ…åšå‡ºä¸€ä¸ªæ’åºï¼Œå¢åŠ 2æ˜¾ç„¶æ’åœ¨å‡å°‘8ä¹‹å‰ã€‚</p>
<p>å› æ­¤ï¼Œè®©æˆ‘ä»¬ç»§ç»­çœ‹å¢åŠ 2æ‰€æ¶‰åŠçš„å€¼</p>
<ol>
<li>æ›´æ”¹åå·®å€¼</li>
<li>æ›´æ”¹æƒå€¼ï¼ˆæ ¹æ®èŠ‚ç‚¹å€¼ï¼‰</li>
<li>æ›´æ”¹ä¸Šä¸€å±‚èŠ‚ç‚¹çš„å€¼ï¼ˆæ ¹æ®æƒå€¼ï¼‰</li>
</ol>
<p>æˆ‘ä»¬å¯¹æƒå€¼å’Œè¾¹æƒåŒæ—¶æ”¹å˜ï¼Œå¹¶ç»Ÿè®¡ä¸‹ä¸€å±‚èŠ‚ç‚¹éœ€è¦çš„å˜åŒ–å¯¹ä¸Šä¸€å±‚çš„èŠ‚ç‚¹å½±å“çš„ç´¯å’Œ</p>
<p>é€šè¿‡å¤šç»„æ•°æ®å¾—å‡ºæƒå€¼çš„æ€»å…±æ”¹å˜å€¼æ”¹å˜å€¼ã€‚è¿™å°±æ˜¯éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic gradient descentï¼‰</p>
<p>ä¸‹é¢ç®€å•è®²ä¸€è®²å…¶ä»–çš„åè¯è§£é‡Š</p>
<h2 id="Mini-batches"><a href="#Mini-batches" class="headerlink" title="Mini-batches"></a>Mini-batches</h2><p>å’Œä»–çš„åå­—ä¸€æ ·ï¼Œè¿™ä¸ªæŠ€æœ¯å°±æ˜¯å°†è®­ç»ƒæ•°æ®åˆ†ä¸ºå‡ ç»„ä»¥æé«˜æ”¶æ•›å‚æ•°çš„æ•ˆç‡</p>
<h2 id="Backpropagation"><a href="#Backpropagation" class="headerlink" title="Backpropagation"></a>Backpropagation</h2><p>åå‘ä¼ æ’­æ˜¯ä¸€ç§æ¢¯åº¦ä¸‹é™æ³•çš„åº”ç”¨ï¼Œé€šè¿‡é“¾å¼æ³•åˆ™è®¡ç®—æŸå¤±å‡½æ•°ç›¸å¯¹äºæ¯ä¸ªæƒé‡çš„æ¢¯åº¦ï¼Œç„¶ååˆ©ç”¨è¿™äº›æ¢¯åº¦æ¥æ›´æ–°æƒé‡ã€‚</p>
<h2 id="å‡½æ•°ä¸è®¡ç®—å›¾"><a href="#å‡½æ•°ä¸è®¡ç®—å›¾" class="headerlink" title="å‡½æ•°ä¸è®¡ç®—å›¾"></a>å‡½æ•°ä¸è®¡ç®—å›¾</h2><p><img src="https://s2.loli.net/2024/06/07/iqHnjI12DSKR6P7.png" alt="compute-graph"></p>
<blockquote>
<p>è®¡ç®—å›¾æ˜¯ç”¨å›¾è®ºè¯­è¨€è¡¨ç¤ºæ•°å­¦å‡½æ•°çš„ä¸€ç§æ–¹å¼ï¼Œä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ æ¡†æ¶è¡¨è¾¾ç¥ç»ç½‘ç»œæ¨¡å‹çš„ç»Ÿä¸€æ–¹æ³•ã€‚æˆ‘ä»¬å°†æ ¹æ®ä¸‹é¢çš„è®¡ç®—å›¾æ„é€ è®¡ç®—å‡½æ•°å’Œç¥ç»ç½‘ç»œã€‚</p>
<p>åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œğ‘¥ä¸ºè¾“å…¥ï¼Œğ‘¦ä¸ºæ­£ç¡®å€¼ï¼Œğ‘¤å’Œğ‘æ˜¯æˆ‘ä»¬éœ€è¦ä¼˜åŒ–çš„å‚æ•°ã€‚</p>
</blockquote>
<ol>
<li>ğ‘¥ä¸ºè¾“å…¥</li>
<li>ğ‘¦ä¸ºæ­£ç¡®å€¼</li>
<li>ğ‘¤å’Œğ‘æ˜¯æˆ‘ä»¬éœ€è¦ä¼˜åŒ–çš„å‚æ•°</li>
</ol>
<p>å³å¯¹åº”äº†åŸå§‹æ•°æ®ï¼Œè¾“å‡ºç»“æœï¼Œæƒé‡å’Œåå·®</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = ops.ones(<span class="number">5</span>, mindspore.float32)  <span class="comment"># input tensor</span></span><br><span class="line">y = ops.zeros(<span class="number">3</span>, mindspore.float32)  <span class="comment"># expected output</span></span><br><span class="line">w = Parameter(Tensor(np.random.randn(<span class="number">5</span>, <span class="number">3</span>), mindspore.float32), name=<span class="string">&#x27;w&#x27;</span>) <span class="comment"># weight</span></span><br><span class="line">b = Parameter(Tensor(np.random.randn(<span class="number">3</span>,), mindspore.float32), name=<span class="string">&#x27;b&#x27;</span>) <span class="comment"># bias</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘ä»¬æ ¹æ®è®¡ç®—å›¾æè¿°çš„è®¡ç®—è¿‡ç¨‹ï¼Œæ„é€ è®¡ç®—å‡½æ•°ã€‚ å…¶ä¸­ï¼Œ<span class="exturl" data-url="aHR0cHM6Ly93d3cubWluZHNwb3JlLmNuL2RvY3MvemgtQ04vcjIuMi9hcGlfcHl0aG9uL29wcy9taW5kc3BvcmUub3BzLmJpbmFyeV9jcm9zc19lbnRyb3B5X3dpdGhfbG9naXRzLmh0bWw=">binary_cross_entropy_with_logits<i class="fa fa-external-link-alt"></i></span> æ˜¯ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œè®¡ç®—é¢„æµ‹å€¼å’Œç›®æ ‡å€¼ä¹‹é—´çš„äºŒå€¼äº¤å‰ç†µæŸå¤±ã€‚</p>
</blockquote>
<p>è§£é‡Šä¸€ä¸‹Parameter(): <strong>Parameter</strong> æ˜¯ Tensor çš„å­ç±»ï¼Œå½“å®ƒä»¬è¢«ç»‘å®šä¸ºCellçš„å±æ€§æ—¶ï¼Œä¼šè‡ªåŠ¨æ·»åŠ åˆ°å…¶å‚æ•°åˆ—è¡¨ä¸­ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡Cellçš„æŸäº›æ–¹æ³•è·å–ï¼Œä¾‹å¦‚ cell.get_<strong>parameter</strong>s() ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">function</span>(<span class="params">x, y, w, b</span>):</span><br><span class="line">    z = ops.matmul(x, w) + b</span><br><span class="line">    loss = ops.binary_cross_entropy_with_logits(z, y, ops.ones_like(z), ops.ones_like(z))</span><br><span class="line">    <span class="keyword">return</span> loss</span><br><span class="line"></span><br><span class="line">loss = function(x, y, w, b)</span><br><span class="line"><span class="built_in">print</span>(loss)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰å¤æ‚æ¦‚å¿µ<a href="#äºŒå€¼äº¤å‰ç†µæŸå¤±"><em>äºŒå€¼äº¤å‰ç†µæŸå¤±</em></a>ï¼Œå¦‚æœä½ ä¸æƒ³æ·±ç©¶åªéœ€è¦è¿™æ˜¯ä¸€ä¸ªå¯¹å‚æ•°çš„å‡½æ•°ï¼Œå½“è¿™ä¸ªå‡½æ•°å€¼æœ€ä½æ—¶ï¼Œæ•´ä½“å‚æ•°å°±æ˜¯ä¸€ä¸ªå‡†ç¡®ç‡è¾ƒé«˜çš„å±€éƒ¨æœ€ä¼˜è§£å³å¯ã€‚</p>
<h2 id="å¾®åˆ†å‡½æ•°ä¸æ¢¯åº¦è®¡ç®—"><a href="#å¾®åˆ†å‡½æ•°ä¸æ¢¯åº¦è®¡ç®—" class="headerlink" title="å¾®åˆ†å‡½æ•°ä¸æ¢¯åº¦è®¡ç®—"></a>å¾®åˆ†å‡½æ•°ä¸æ¢¯åº¦è®¡ç®—</h2><blockquote>
<p> ä¸ºäº†ä¼˜åŒ–æ¨¡å‹å‚æ•°ï¼Œéœ€è¦æ±‚å‚æ•°å¯¹lossçš„å¯¼æ•°ï¼š<script type="math/tex">\frac{ğœ•loss}{ğœ•ğ‘¤}</script>å’Œ<script type="math/tex">\frac{ğœ•loss}{ğœ•ğ‘}</script>ï¼Œæ­¤æ—¶æˆ‘ä»¬è°ƒç”¨<code>mindspore.grad</code>å‡½æ•°ï¼Œæ¥è·å¾—<code>function</code>çš„å¾®åˆ†å‡½æ•°ã€‚</p>
<p>è¿™é‡Œä½¿ç”¨äº†<code>grad</code>å‡½æ•°çš„ä¸¤ä¸ªå…¥å‚ï¼Œåˆ†åˆ«ä¸ºï¼š</p>
<ul>
<li><code>fn</code>ï¼šå¾…æ±‚å¯¼çš„å‡½æ•°ã€‚</li>
<li><code>grad_position</code>ï¼šæŒ‡å®šæ±‚å¯¼è¾“å…¥ä½ç½®çš„ç´¢å¼•ã€‚</li>
</ul>
<p>ç”±äºæˆ‘ä»¬å¯¹<script type="math/tex">ğ‘¤</script>å’Œ<script type="math/tex">ğ‘</script>â€‹æ±‚å¯¼ï¼Œå› æ­¤é…ç½®å…¶åœ¨<code>function</code>å…¥å‚å¯¹åº”çš„ä½ç½®<code>(2, 3)</code>ã€‚</p>
<p><em>ä½¿ç”¨<code>grad</code>è·å¾—å¾®åˆ†å‡½æ•°æ˜¯ä¸€ç§å‡½æ•°å˜æ¢ï¼Œå³è¾“å…¥ä¸ºå‡½æ•°ï¼Œè¾“å‡ºä¹Ÿä¸ºå‡½æ•°ã€‚</em></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grad_fn = mindspore.grad(function, (<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">grads = grad_fn(x, y, w, b)</span><br><span class="line"><span class="built_in">print</span>(grads)</span><br></pre></td></tr></table></figure>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(Tensor(shape=[5, 3], dtype=Float32, value=</span><br><span class="line">[[ 8.17961693e-02,  1.48393542e-01,  6.00685179e-03],</span><br><span class="line"> [ 8.17961693e-02,  1.48393542e-01,  6.00685179e-03],</span><br><span class="line"> [ 8.17961693e-02,  1.48393542e-01,  6.00685179e-03],</span><br><span class="line"> [ 8.17961693e-02,  1.48393542e-01,  6.00685179e-03],</span><br><span class="line"> [ 8.17961693e-02,  1.48393542e-01,  6.00685179e-03]]), Tensor(shape=[3], dtype=Float32, value= [ 8.17961693e-02,  1.48393542e-01,  6.00685179e-03]))</span><br></pre></td></tr></table></figure>
</blockquote>
<p>æ‰§è¡Œå¾®åˆ†å‡½æ•°ï¼Œå³å¯è·å¾—<script type="math/tex">ğ‘¤</script>ã€<script type="math/tex">ğ‘</script>â€‹å¯¹åº”çš„æ¢¯åº¦ã€‚å¯ä»¥æ³¨æ„åˆ°w,bçš„æ¢¯åº¦ä¸æœ€åˆå§‹çš„æ¢¯åº¦æ˜¯ä¸€è‡´çš„ã€‚</p>
<h3 id="Stop-Gradient"><a href="#Stop-Gradient" class="headerlink" title="Stop Gradient"></a>Stop Gradient</h3><blockquote>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ±‚å¯¼æ—¶ä¼šæ±‚losså¯¹å‚æ•°çš„å¯¼æ•°ï¼Œå› æ­¤å‡½æ•°çš„è¾“å‡ºåªæœ‰lossä¸€é¡¹ã€‚<strong>å½“æˆ‘ä»¬å¸Œæœ›å‡½æ•°è¾“å‡ºå¤šé¡¹æ—¶ï¼Œå¾®åˆ†å‡½æ•°ä¼šæ±‚æ‰€æœ‰è¾“å‡ºé¡¹å¯¹å‚æ•°çš„å¯¼æ•°</strong>ã€‚æ­¤æ—¶å¦‚æœæƒ³å®ç°å¯¹æŸä¸ªè¾“å‡ºé¡¹çš„æ¢¯åº¦æˆªæ–­ï¼Œæˆ–æ¶ˆé™¤æŸä¸ªTensorå¯¹æ¢¯åº¦çš„å½±å“ï¼Œéœ€è¦ç”¨åˆ°Stop Gradientæ“ä½œã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å°†<code>function</code>æ”¹ä¸ºåŒæ—¶è¾“å‡ºlosså’Œzçš„<code>function_with_logits</code>ï¼Œè·å¾—å¾®åˆ†å‡½æ•°å¹¶æ‰§è¡Œã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">function_with_logits</span>(<span class="params">x, y, w, b</span>):</span><br><span class="line">    z = ops.matmul(x, w) + b</span><br><span class="line">    loss = ops.binary_cross_entropy_with_logits(z, y, ops.ones_like(z), ops.ones_like(z))</span><br><span class="line">    <span class="keyword">return</span> loss, z</span><br><span class="line"></span><br><span class="line">grad_fn = mindspore.grad(function_with_logits, (<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">grads = grad_fn(x, y, w, b)</span><br><span class="line"><span class="built_in">print</span>(grads)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">function_stop_gradient</span>(<span class="params">x, y, w, b</span>):</span><br><span class="line">    z = ops.matmul(x, w) + b</span><br><span class="line">    loss = ops.binary_cross_entropy_with_logits(z, y, ops.ones_like(z), ops.ones_like(z))</span><br><span class="line">    <span class="keyword">return</span> loss, ops.stop_gradient(z)</span><br><span class="line"></span><br><span class="line">grad_fn = mindspore.grad(function_stop_gradient, (<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">grads = grad_fn(x, y, w, b)</span><br><span class="line"><span class="built_in">print</span>(grads)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>ops.stop_gradient(z)</code>:é‡ç‚¹åœ¨è¯¥å‡½æ•°ï¼Œè¡¨ç¤ºå±è”½äº†zå¯¹æ¢¯åº¦çš„å½±å“ï¼Œå³ä»åªæ±‚å‚æ•°å¯¹lossçš„å¯¼æ•°ã€‚</p>
<p>è¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸€äº›apiçš„å«ä¹‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mindspore.grad(fn, grad_position=<span class="number">0</span>, weights=<span class="literal">None</span>, has_aux=<span class="literal">False</span>, return_ids=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cubWluZHNwb3JlLmNuL2RvY3MvemgtQ04vcjIuMi9hcGlfcHl0aG9uL21pbmRzcG9yZS9taW5kc3BvcmUuZ3JhZC5odG1sP2hpZ2hsaWdodD1ncmFkI21pbmRzcG9yZS5ncmFk">MindSpore<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mindspore.numpy.matmul(x1, x2, dtype=None)</span><br></pre></td></tr></table></figure>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cubWluZHNwb3JlLmNuL2RvY3MvemgtQ04vcjIuMi9hcGlfcHl0aG9uL251bXB5L21pbmRzcG9yZS5udW1weS5tYXRtdWwuaHRtbD9oaWdobGlnaHQ9bWF0bXVsI21pbmRzcG9yZS5udW1weS5tYXRtdWw=">MindSpore<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="Auxiliary-data"><a href="#Auxiliary-data" class="headerlink" title="Auxiliary data"></a>Auxiliary data</h3><p>Auxiliary dataæ„ä¸ºè¾…åŠ©æ•°æ®ï¼Œæ˜¯å‡½æ•°é™¤ç¬¬ä¸€ä¸ªè¾“å‡ºé¡¹å¤–çš„å…¶ä»–è¾“å‡ºã€‚é€šå¸¸æˆ‘ä»¬ä¼šå°†å‡½æ•°çš„lossè®¾ç½®ä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªè¾“å‡ºï¼Œå…¶ä»–çš„è¾“å‡ºå³ä¸ºè¾…åŠ©æ•°æ®ã€‚</p>
<p><code>grad</code>å’Œ<code>value_and_grad</code>æä¾›<code>has_aux</code>å‚æ•°ï¼Œå½“å…¶è®¾ç½®ä¸º<code>True</code>æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨å®ç°å‰æ–‡æ‰‹åŠ¨æ·»åŠ <code>stop_gradient</code>çš„åŠŸèƒ½ï¼Œæ»¡è¶³è¿”å›è¾…åŠ©æ•°æ®çš„åŒæ—¶ä¸å½±å“æ¢¯åº¦è®¡ç®—çš„æ•ˆæœã€‚</p>
<p>ä¸‹é¢ä»ä½¿ç”¨<code>function_with_logits</code>ï¼Œé…ç½®<code>has_aux=True</code>ï¼Œå¹¶æ‰§è¡Œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grad_fn = mindspore.grad(function_with_logits, (<span class="number">2</span>, <span class="number">3</span>), has_aux=<span class="literal">True</span>)</span><br><span class="line">grads, (z,) = grad_fn(x, y, w, b)</span><br><span class="line"><span class="built_in">print</span>(grads, z)</span><br></pre></td></tr></table></figure>
<h3 id="ç¥ç»ç½‘ç»œæ¢¯åº¦è®¡ç®—"><a href="#ç¥ç»ç½‘ç»œæ¢¯åº¦è®¡ç®—" class="headerlink" title="ç¥ç»ç½‘ç»œæ¢¯åº¦è®¡ç®—"></a>ç¥ç»ç½‘ç»œæ¢¯åº¦è®¡ç®—</h3><blockquote>
<p> å‰è¿°ç« èŠ‚ä¸»è¦æ ¹æ®è®¡ç®—å›¾å¯¹åº”çš„å‡½æ•°ä»‹ç»äº†MindSporeçš„å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†ï¼Œä½†æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ„é€ æ˜¯ç»§æ‰¿è‡ªé¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼çš„<code>nn.Cell</code>ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡<code>Cell</code>æ„é€ åŒæ ·çš„ç¥ç»ç½‘ç»œï¼Œåˆ©ç”¨å‡½æ•°å¼è‡ªåŠ¨å¾®åˆ†æ¥å®ç°åå‘ä¼ æ’­ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬ç»§æ‰¿<code>nn.Cell</code>æ„é€ å•å±‚çº¿æ€§å˜æ¢ç¥ç»ç½‘ç»œã€‚è¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å‰æ–‡çš„ğ‘¤ã€ğ‘ä½œä¸ºæ¨¡å‹å‚æ•°ï¼Œä½¿ç”¨<code>mindspore.Parameter</code>è¿›è¡ŒåŒ…è£…åï¼Œä½œä¸ºå†…éƒ¨å±æ€§ï¼Œå¹¶åœ¨<code>construct</code>å†…å®ç°ç›¸åŒçš„Tensoræ“ä½œã€‚</p>
</blockquote>
<p>è¿™é‡Œå‡ºç°äº†åå‘ä¼ æ’­æ–¹æ³•,å¹¶ä¸”æ˜¯åŒ…è£…å¥½çš„,å»ºè®®è¯»è€…ä»”ç»†çœ‹ä¸€ä¸‹ä»£ç å¹¶å°è¯•è‡ªå·±è¿è¡Œä¸€ä¸‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰ç¥ç»ç½‘ç»œæ¨¡å‹</span></span><br><span class="line"><span class="comment"># Define model</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Network</span>(nn.Cell):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="variable language_">self</span>.w = w</span><br><span class="line">        <span class="variable language_">self</span>.b = b</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">construct</span>(<span class="params">self, x</span>):</span><br><span class="line">        z = ops.matmul(x, <span class="variable language_">self</span>.w) + <span class="variable language_">self</span>.b</span><br><span class="line">        <span class="keyword">return</span> z</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Instantiate model</span></span><br><span class="line">model = Network()</span><br><span class="line"><span class="comment"># Instantiate loss function</span></span><br><span class="line">loss_fn = nn.BCEWithLogitsLoss()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define forward function</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward_fn</span>(<span class="params">x, y</span>):</span><br><span class="line">    z = model(x)</span><br><span class="line">    loss = loss_fn(z, y)</span><br><span class="line">    <span class="keyword">return</span> loss</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨å…¥æŸå¤±å‡½æ•°</span></span><br><span class="line">grad_fn = mindspore.value_and_grad(forward_fn, <span class="literal">None</span>, weights=model.trainable_params())</span><br><span class="line">loss, grads = grad_fn(x, y)</span><br><span class="line"><span class="built_in">print</span>(grads)</span><br></pre></td></tr></table></figure>
<h3 id="æ€»ç»“è¾“å‡ºï¼ˆå•æ¬¡ï¼‰"><a href="#æ€»ç»“è¾“å‡ºï¼ˆå•æ¬¡ï¼‰" class="headerlink" title="æ€»ç»“è¾“å‡ºï¼ˆå•æ¬¡ï¼‰"></a>æ€»ç»“è¾“å‡ºï¼ˆå•æ¬¡ï¼‰</h3><blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">0.92031693</span><br><span class="line">(Tensor(shape=[5, 3], dtype=Float32, value=</span><br><span class="line">[[ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01]]), Tensor(shape=[3], dtype=Float32, value= [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01]))</span><br><span class="line">è®¡ç®—å¤šä¸ªå‚æ•°çš„å¯¼æ•°</span><br><span class="line">(Tensor(shape=[5, 3], dtype=Float32, value=</span><br><span class="line">[[ 1.23408186e+00,  1.21728730e+00,  1.13000238e+00],</span><br><span class="line"> [ 1.23408186e+00,  1.21728730e+00,  1.13000238e+00],</span><br><span class="line"> [ 1.23408186e+00,  1.21728730e+00,  1.13000238e+00],</span><br><span class="line"> [ 1.23408186e+00,  1.21728730e+00,  1.13000238e+00],</span><br><span class="line"> [ 1.23408186e+00,  1.21728730e+00,  1.13000238e+00]]), Tensor(shape=[3], dtype=Float32, value= [ 1.23408186e+00,  1.21728730e+00,  1.13000238e+00]))</span><br><span class="line">æ¶ˆé™¤éƒ¨åˆ†å¼ é‡å¯¹æ¢¯åº¦çš„å½±å“</span><br><span class="line">(Tensor(shape=[5, 3], dtype=Float32, value=</span><br><span class="line">[[ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01]]), Tensor(shape=[3], dtype=Float32, value= [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01]))</span><br><span class="line">Auxiliary data è¾…åŠ©æ•°æ®æµ‹è¯•</span><br><span class="line">(Tensor(shape=[5, 3], dtype=Float32, value=</span><br><span class="line">[[ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01]]), Tensor(shape=[3], dtype=Float32, value= [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01])) [ 0.8580145   0.62723386 -0.44728255]      </span><br><span class="line">å¼€å§‹å®æµ‹ç½‘ç»œæ¨¡å‹çš„åå‘ä¼ æ’­</span><br><span class="line">(Tensor(shape=[5, 3], dtype=Float32, value=</span><br><span class="line">[[ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01],</span><br><span class="line"> [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01]]), Tensor(shape=[3], dtype=Float32, value= [ 2.34081909e-01,  2.17287347e-01,  1.30002365e-01]))</span><br></pre></td></tr></table></figure>
</blockquote>
<p>å¯è§ï¼Œé™¤äº†åœ¨è®¡ç®—zçš„å¯¼æ•°å¯¹æ¢¯åº¦çš„å½±å“æƒ…å†µä¸‹ï¼Œå‡ä¿æŒäº†ç›¸åŒçš„è¾“å‡ºï¼Œå¹¶ä¸”å¯ä»¥è§‚å¯Ÿåˆ°w,bçš„æƒå€¼</p>
<h2 id="äºŒå€¼äº¤å‰ç†µæŸå¤±"><a href="#äºŒå€¼äº¤å‰ç†µæŸå¤±" class="headerlink" title="äºŒå€¼äº¤å‰ç†µæŸå¤±"></a>äºŒå€¼äº¤å‰ç†µæŸå¤±</h2><p><strong><em>ä»¥ä¸‹çš„å¯¹æ•°å‡ä¸ºè‡ªç„¶å¯¹æ•°</em></strong></p>
<p>Binary cross entropy äºŒå…ƒ<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kv5Lqk5Y+J54a1">äº¤å‰ç†µ<i class="fa fa-external-link-alt"></i></span>æ˜¯äºŒåˆ†ç±»é—®é¢˜ä¸­å¸¸ç”¨çš„ä¸€ä¸ªLossæŸå¤±å‡½æ•°ï¼Œåœ¨å¸¸è§çš„æœºå™¨å­¦ä¹ æ¨¡å—ä¸­éƒ½æœ‰å®ç°ã€‚å°±äºŒå…ƒäº¤å‰ç†µè¿™ä¸ªæŸå¤±å‡½æ•°çš„åŸç†ï¼Œç®€å•åœ°è¿›è¡Œè§£é‡Šã€‚ä¸‹é¢æ˜¯äºŒå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°çš„å…¬å¼</p>
<script type="math/tex; mode=display">
L=-\frac1N \sum_{i=1}^{N}[y_ilog(p_i)+(1-y_i)log(1-p_i)]</script><p>å…ˆä¸å°è¯•ç†è§£ä»–ï¼Œå…ˆçœ‹çœ‹ä»–æ˜¯å¦‚ä½•è¿ä½œçš„</p>
<p><img src="https://s2.loli.net/2024/06/07/MAOZxqKodRSW6uy.jpg" alt="img"></p>
<script type="math/tex; mode=display">
L=\frac13[(1*log0.8+(1-1)*log(1-0.8))+(0*log0.2+(1-0)*log(1-0.2))+(0*log0.4+(1-0)*log(1-0.4))]=0.319 \\</script><p>å¯¹äºä»¥ä¸Šçš„æ¡ˆä¾‹è®¡ç®—æŸå¤±å‡½æ•°ï¼Œç»“æœæ˜¯0.31903</p>
<h3 id="ä»ç†µæ¥çœ‹äº¤å‰ç†µæŸå¤±"><a href="#ä»ç†µæ¥çœ‹äº¤å‰ç†µæŸå¤±" class="headerlink" title="ä»ç†µæ¥çœ‹äº¤å‰ç†µæŸå¤±"></a>ä»ç†µæ¥çœ‹äº¤å‰ç†µæŸå¤±</h3><h4 id="ä¿¡æ¯é‡"><a href="#ä¿¡æ¯é‡" class="headerlink" title="ä¿¡æ¯é‡"></a>ä¿¡æ¯é‡</h4><p>ä¿¡æ¯é‡æ¥è¡¡é‡ä¸€ä¸ªäº‹ä»¶çš„ä¸ç¡®å®šæ€§ï¼Œä¸€ä¸ªäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡è¶Šå¤§ï¼Œä¸ç¡®å®šæ€§è¶Šå°ï¼Œåˆ™å…¶æºå¸¦çš„ä¿¡æ¯é‡å°±è¶Šå°ã€‚</p>
<p>è®¾<script type="math/tex">X</script>æ˜¯ä¸€ä¸ªç¦»æ•£å‹éšæœºå˜é‡ï¼Œå…¶å–å€¼ä¸ºé›†åˆ<script type="math/tex">X = {x_0,x_1,\dots,x_n}</script>ï¼Œåˆ™å…¶æ¦‚ç‡åˆ†å¸ƒå‡½æ•°ä¸º<script type="math/tex">p(x) = Pr(X = x),x \in X</script>ï¼Œåˆ™å®šä¹‰äº‹ä»¶<script type="math/tex">X=x_0</script>çš„ä¿¡æ¯é‡ä¸ºï¼š</p>
<script type="math/tex; mode=display">
I(x_0) = -\log(p(x_0))</script><p>å½“<script type="math/tex">p(x_0) = 1</script>æ—¶ï¼Œå…¶æºå¸¦çš„ä¿¡æ¯é‡ä¸º0ã€‚</p>
<h4 id="ç†µ"><a href="#ç†µ" class="headerlink" title="ç†µ"></a>ç†µ</h4><p>ç†µç”¨æ¥è¡¡é‡ä¸€ä¸ªç³»ç»Ÿçš„æ··ä¹±ç¨‹åº¦ï¼Œä»£è¡¨ç³»ç»Ÿä¸­ä¿¡æ¯é‡çš„æ€»å’Œï¼›ç†µå€¼è¶Šå¤§ï¼Œè¡¨æ˜è¿™ä¸ªç³»ç»Ÿçš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ã€‚å…·ä½“è€Œæ•°å­¦çš„è®²ï¼Œç†µå°±æ˜¯ä¸€ä¸ªç³»ç»Ÿä¸­æ‰€æœ‰ä¿¡æ¯é‡çš„æœŸæœ›ã€‚</p>
<p>ä¿¡æ¯é‡æ˜¯è¡¡é‡æŸä¸ªäº‹ä»¶çš„ä¸ç¡®å®šæ€§ï¼Œè€Œç†µæ˜¯è¡¡é‡ä¸€ä¸ªç³»ç»Ÿï¼ˆæ‰€æœ‰äº‹ä»¶ï¼‰çš„ä¸ç¡®å®šæ€§ã€‚</p>
<p>ç†µçš„è®¡ç®—å…¬å¼</p>
<script type="math/tex; mode=display">
H(x) = -\sum_{i=1}^np(x_i)\log(p(x_i))</script><p>æ¯”è¾ƒç‰¹æ®Šçš„æœ‰äºŒé¡¹åˆ†å¸ƒç†µ</p>
<script type="math/tex; mode=display">
\begin{eqnarray}
H(X)&=&-\sum_{i=1}^n p(x_i)log(p(x_i))\\
&=&-p(x)log(p(x))-(1-p(x))log(1-p(x))
\end{eqnarray}</script><p><em>ç†µä¹Ÿæœ‰å…¶ä»–ç±»å‹çš„è®¡ç®—å…¬å¼ï¼Œè¿™é‡Œæ˜¯ä¿¡æ¯å­¦ä¸Šçš„å®šä¹‰</em></p>
<p>å…¶ä¸­<script type="math/tex">p(x)</script>ä¸ºè¿™ä»¶äº‹å‘ç”Ÿçš„æ¦‚ç‡ï¼Œ<script type="math/tex">-log(p(x_i))</script>æ˜¯äº‹ä»¶<script type="math/tex">x_i</script>æ‰€æºå¸¦çš„ä¿¡æ¯é‡ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œç†µæ˜¯ä¿¡æ¯é‡çš„æœŸæœ›å€¼ï¼Œæ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼ˆä¸€ä¸ªç³»ç»Ÿï¼Œäº‹ä»¶æ‰€æœ‰å¯èƒ½æ€§ï¼‰ä¸ç¡®å®šæ€§çš„åº¦é‡ã€‚ç†µå€¼è¶Šå¤§ï¼Œéšæœºå˜é‡çš„å–å€¼å°±è¶Šéš¾ç¡®å®šï¼Œç³»ç»Ÿä¹Ÿå°±è¶Šä¸ç¨³å®šï¼›ç†µå€¼è¶Šå°ï¼Œéšæœºå˜é‡çš„å–å€¼ä¹Ÿå°±è¶Šå®¹æ˜“ç¡®å®šï¼Œç³»ç»Ÿè¶Šç¨³å®šã€‚</p>
<h4 id="ç›¸å¯¹ç†µ-ï¼ˆRelative-entropyï¼‰-KLæ•£åº¦"><a href="#ç›¸å¯¹ç†µ-ï¼ˆRelative-entropyï¼‰-KLæ•£åº¦" class="headerlink" title="ç›¸å¯¹ç†µ ï¼ˆRelative entropyï¼‰/  KLæ•£åº¦"></a>ç›¸å¯¹ç†µ ï¼ˆRelative entropyï¼‰/  KLæ•£åº¦</h4><p>wikiå¯¹ç›¸å¯¹ç†µçš„å®šä¹‰å¦‚ä¸‹ï¼š<code>In the context of machine learning, DKL(Pâ€–Q) is often called the information gain achieved if P is used instead of Q.</code></p>
<p>å³å¦‚æœç”¨Pæ¥æè¿°ç›®æ ‡é—®é¢˜ï¼Œè€Œä¸æ˜¯ç”¨Qæ¥æè¿°ç›®æ ‡é—®é¢˜ï¼Œå¾—åˆ°çš„ä¿¡æ¯å¢é‡ã€‚</p>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼ŒPå¾€å¾€ç”¨æ¥è¡¨ç¤ºæ ·æœ¬çš„çœŸå®åˆ†å¸ƒï¼Œæ¯”å¦‚[1,0,0]è¡¨ç¤ºå½“å‰æ ·æœ¬å±äºç¬¬ä¸€ç±»ã€‚Qç”¨æ¥è¡¨ç¤ºæ¨¡å‹æ‰€é¢„æµ‹çš„åˆ†å¸ƒï¼Œæ¯”å¦‚[0.7,0.2,0.1]ç›´è§‚çš„ç†è§£å°±æ˜¯å¦‚æœç”¨Pæ¥æè¿°æ ·æœ¬ï¼Œé‚£ä¹ˆå°±éå¸¸å®Œç¾ã€‚è€Œç”¨Qæ¥æè¿°æ ·æœ¬ï¼Œè™½ç„¶å¯ä»¥å¤§è‡´æè¿°ï¼Œä½†æ˜¯ä¸æ˜¯é‚£ä¹ˆçš„å®Œç¾ï¼Œä¿¡æ¯é‡ä¸è¶³ï¼Œéœ€è¦é¢å¤–çš„ä¸€äº›â€œä¿¡æ¯å¢é‡â€æ‰èƒ½è¾¾åˆ°å’ŒPä¸€æ ·å®Œç¾çš„æè¿°ã€‚å¦‚æœæˆ‘ä»¬çš„Qé€šè¿‡åå¤è®­ç»ƒï¼Œä¹Ÿèƒ½å®Œç¾çš„æè¿°æ ·æœ¬ï¼Œé‚£ä¹ˆå°±ä¸å†éœ€è¦é¢å¤–çš„â€œä¿¡æ¯å¢é‡â€ï¼ŒQç­‰ä»·äºPã€‚</p>
<p>æ€»ç»“ï¼šç›¸å¯¹ç†µä¹Ÿç§°ä¸ºKLæ•£åº¦(Kullback-Leibler divergence)ï¼Œè¡¨ç¤ºåŒä¸€ä¸ªéšæœºå˜é‡çš„ä¸¤ä¸ªä¸åŒåˆ†å¸ƒé—´çš„è·ç¦»ã€‚</p>
<p>è®¾ <script type="math/tex">p(x),ğ‘(ğ‘¥)</script>åˆ†åˆ«æ˜¯ ç¦»æ•£éšæœºå˜é‡<script type="math/tex">X</script>çš„ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œåˆ™<script type="math/tex">p</script>å¯¹<script type="math/tex">q</script>çš„ç›¸å¯¹ç†µæ˜¯ï¼š</p>
<script type="math/tex; mode=display">
D_{KL}(p \parallel q) = \sum_i p(x_i) log(\frac{p(x_i)}{q(x_i)})</script><p>ç›¸å¯¹ç†µå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ul>
<li>å¦‚æœp(x)å’Œq(x)çš„åˆ†å¸ƒç›¸åŒï¼Œåˆ™å…¶ç›¸å¯¹ç†µç­‰äº0</li>
<li><script type="math/tex">D_{KL}(pâˆ¥q)â‰ D_{KL}(qâˆ¥p)ğ·_{ğ¾ğ¿}(ğ‘âˆ¥ğ‘)â‰ ğ·_{ğ¾ğ¿}(ğ‘âˆ¥ğ‘)</script>ï¼Œä¹Ÿå°±æ˜¯ç›¸å¯¹ç†µä¸å…·æœ‰å¯¹ç§°æ€§ã€‚</li>
<li><script type="math/tex; mode=display">D_{KL}(pâˆ¥q)â‰¥0</script></li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼Œç›¸å¯¹ç†µæ˜¯ç”¨æ¥è¡¡é‡åŒä¸€ä¸ªéšæœºå˜é‡çš„ä¸¤ä¸ªä¸åŒåˆ†å¸ƒä¹‹é—´çš„è·ç¦»ã€‚<strong>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå‡å¦‚p(x)æ˜¯ç›®æ ‡çœŸå®çš„åˆ†å¸ƒï¼Œè€Œq(x)æ˜¯é¢„æµ‹å¾—æ¥çš„åˆ†å¸ƒï¼Œä¸ºäº†è®©è¿™ä¸¤ä¸ªåˆ†å¸ƒå°½å¯èƒ½çš„ç›¸åŒçš„ï¼Œå°±éœ€è¦æœ€å°åŒ–KLæ•£åº¦ã€‚</strong></p>
<h4 id="äº¤å‰ç†µ-Cross-Entropy"><a href="#äº¤å‰ç†µ-Cross-Entropy" class="headerlink" title="äº¤å‰ç†µ Cross Entropy"></a>äº¤å‰ç†µ Cross Entropy</h4><p>è®¾<script type="math/tex">p(x),q(x)</script>åˆ†åˆ«æ˜¯ ç¦»æ•£éšæœºå˜é‡<script type="math/tex">X</script>çš„ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œå…¶ä¸­<script type="math/tex">p(x)</script>æ˜¯ç›®æ ‡åˆ†å¸ƒï¼Œ<script type="math/tex">p</script>å’Œ<script type="math/tex">q</script>çš„äº¤å‰ç†µå¯ä»¥çœ‹åšæ˜¯ï¼Œä½¿ç”¨åˆ†å¸ƒ<script type="math/tex">q(x)</script>è¡¨ç¤ºç›®æ ‡åˆ†å¸ƒ<script type="math/tex">p(x)</script>çš„å›°éš¾ç¨‹åº¦</p>
<script type="math/tex; mode=display">
H(p,q) = \sum_ip(x_i)log\frac{1}{\log q(x_i)} = -\sum_ip(x_i)\log q(x_i)</script><p>å°†ç†µã€ç›¸å¯¹ç†µä»¥åŠäº¤å‰ç†µçš„å…¬å¼æ”¾åˆ°ä¸€èµ·ï¼Œ</p>
<script type="math/tex; mode=display">
\begin{align}
H(p) &= -\sum_{i}p(x_i) \log p(x_i) \\
D_{KL}(p \parallel q) &= \sum_{i}p(x_i)\log \frac{p(x_i)}{q(x_i)} = \sum_i (p(x_i)\log p(x_i) - p(x_i) \log q(x_i)) \\
H(p,q) &=  -\sum_ip(x_i)\log q(x_i)
\end{align}</script><p>é€šè¿‡ä¸Šé¢ä¸‰ä¸ªå…¬å¼å°±å¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
D_{KL}(p,q) = H(p,q)- H(p)</script><p>å…¶ä¸­ï¼Œå‰ä¸€é¡¹<script type="math/tex">H(p,q)</script>å°±æ˜¯<script type="math/tex">p,q</script>çš„äº¤å‰ç†µã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç›®æ ‡çš„åˆ†å¸ƒ<script type="math/tex">p(x)</script>é€šå¸¸æ˜¯è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒæ˜¯å›ºå®šï¼Œå³æ˜¯<script type="math/tex">H(p)</script>æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚è¿™æ ·ä¸¤ä¸ªåˆ†å¸ƒçš„äº¤å‰ç†µ<script type="math/tex">H(p,q)</script>ä¹Ÿå°±ç­‰ä»·äºæœ€å°åŒ–è¿™ä¸¤ä¸ªåˆ†å¸ƒçš„ç›¸å¯¹ç†µ<script type="math/tex">D_{KL}(p \parallel q)</script></p>
<p>è®¾<script type="math/tex">p(x)</script>æ˜¯ç›®æ ‡åˆ†å¸ƒï¼ˆè®­ç»ƒæ•°æ®çš„åˆ†å¸ƒï¼‰ï¼Œæˆ‘ä»¬çš„ç›®æ ‡çš„å°±è®©è®­ç»ƒå¾—åˆ°çš„åˆ†å¸ƒ<script type="math/tex">q(x)</script>å°½å¯èƒ½çš„æ¥è¿‘<script type="math/tex">p(x)</script>ï¼Œè¿™æ—¶å€™å°±å¯ä»¥æœ€å°åŒ–<script type="math/tex">D_{KL}(pâˆ¥q)</script>ï¼Œç­‰ä»·äºæœ€å°åŒ–äº¤å‰ç†µ<script type="math/tex">H(p,q)</script>â€‹ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰ç†µåšlosså‡½æ•°"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰ç†µåšlosså‡½æ•°" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰ç†µåšlosså‡½æ•°"></a>ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰ç†µåšlosså‡½æ•°</h3><p>åœ¨çº¿æ€§å›å½’é—®é¢˜ä¸­ï¼Œå¸¸å¸¸ä½¿ç”¨MSEï¼ˆMean Squared Errorï¼‰ä½œä¸ºlosså‡½æ•°ï¼Œæ¯”å¦‚ï¼š</p>
<script type="math/tex; mode=display">
loss = \frac{1}{2m}\sum_{i=1}^m(y_i-\hat{y_i})^2</script><p>è¿™é‡Œçš„mè¡¨ç¤ºmä¸ªæ ·æœ¬çš„ï¼Œlossä¸ºmä¸ªæ ·æœ¬çš„losså‡å€¼ã€‚<br>MSEåœ¨<a href="# å›å½’é—®é¢˜">çº¿æ€§å›å½’é—®é¢˜</a>ä¸­æ¯”è¾ƒå¥½ç”¨ï¼Œé‚£ä¹ˆåœ¨é€»è¾‘åˆ†ç±»é—®é¢˜ä¸­è¿˜æ˜¯å¦‚æ­¤ä¹ˆï¼Ÿ</p>
<h3 id="äº¤å‰ç†µåœ¨å•åˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨"><a href="#äº¤å‰ç†µåœ¨å•åˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨" class="headerlink" title="äº¤å‰ç†µåœ¨å•åˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨"></a>äº¤å‰ç†µåœ¨å•åˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨</h3><p>è¿™é‡Œçš„å•ç±»åˆ«æ˜¯æŒ‡ï¼Œæ¯ä¸€å¼ å›¾åƒæ ·æœ¬åªèƒ½æœ‰ä¸€ä¸ªç±»åˆ«ï¼Œæ¯”å¦‚åªèƒ½æ˜¯ç‹—æˆ–åªèƒ½æ˜¯çŒ«ã€‚<br>äº¤å‰ç†µåœ¨å•åˆ†ç±»é—®é¢˜ä¸ŠåŸºæœ¬æ˜¯æ ‡é…çš„æ–¹æ³•</p>
<script type="math/tex; mode=display">
loss=-\sum_{i=1}^{n}y_ilog(\hat{y_i})</script><p>ä¸Šå¼ä¸ºä¸€å¼ æ ·æœ¬çš„lossè®¡ç®—æ–¹æ³•ã€‚nä»£è¡¨ç€nç§ç±»åˆ«ã€‚<br>ä¸¾ä¾‹è¯´æ˜,æ¯”å¦‚æœ‰å¦‚ä¸‹æ ·æœ¬</p>
<p>å¯¹åº”çš„æ ‡ç­¾å’Œé¢„æµ‹å€¼</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>*</th>
<th>çŒ«</th>
<th>é’è›™</th>
<th>è€é¼ </th>
</tr>
</thead>
<tbody>
<tr>
<td>Label</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>Pred</td>
<td>0.3</td>
<td>0.6</td>
<td>0.1</td>
</tr>
</tbody>
</table>
</div>
<script type="math/tex; mode=display">
\begin{eqnarray}
loss&=&-(0\times log(0.3)+1\times log(0.6)+0\times log(0.1)\\
&=&-log(0.6)
\end{eqnarray}</script><p>å¯¹åº”çš„ä¸€ä¸ªbatchçš„losså°±æ˜¯</p>
<script type="math/tex; mode=display">
loss=-\frac{1}{m}\sum_{j=1}^m\sum_{i=1}^{n}y_{ji}log(\hat{y_{ji}})</script><p>mä¸ºå½“å‰batchçš„æ ·æœ¬æ•°</p>
<h3 id="äº¤å‰ç†µåœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨"><a href="#äº¤å‰ç†µåœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨" class="headerlink" title="äº¤å‰ç†µåœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨"></a>äº¤å‰ç†µåœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­çš„ä½¿ç”¨</h3><p>è¿™é‡Œçš„å¤šç±»åˆ«æ˜¯æŒ‡ï¼Œæ¯ä¸€å¼ å›¾åƒæ ·æœ¬å¯ä»¥æœ‰å¤šä¸ªç±»åˆ«ï¼Œæ¯”å¦‚åŒæ—¶åŒ…å«ä¸€åªçŒ«å’Œä¸€åªç‹—<br>å’Œå•åˆ†ç±»é—®é¢˜çš„æ ‡ç­¾ä¸åŒï¼Œå¤šåˆ†ç±»çš„æ ‡ç­¾æ˜¯n-hotã€‚<br>æ¯”å¦‚ä¸‹é¢è¿™å¼ æ ·æœ¬å›¾ï¼Œå³æœ‰é’è›™ï¼Œåˆæœ‰è€é¼ ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªå¤šåˆ†ç±»é—®é¢˜</p>
<p>æ —å­</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>*</th>
<th>çŒ«</th>
<th>é’è›™</th>
<th>è€é¼ </th>
</tr>
</thead>
<tbody>
<tr>
<td>Label</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Pred</td>
<td>0.1</td>
<td>0.7</td>
<td>0.8</td>
</tr>
</tbody>
</table>
</div>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„Predä¸å†æ˜¯é€šè¿‡softmaxè®¡ç®—çš„äº†ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯sigmoidã€‚å°†æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„è¾“å‡ºå½’ä¸€åŒ–åˆ°[0,1]ä¹‹é—´ã€‚æ‰€æœ‰Predå€¼çš„å’Œä¹Ÿä¸å†ä¸º1ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ¯ä¸€ä¸ªLabeléƒ½æ˜¯ç‹¬ç«‹åˆ†å¸ƒçš„ï¼Œç›¸äº’ä¹‹é—´æ²¡æœ‰å½±å“ã€‚æ‰€ä»¥äº¤å‰ç†µåœ¨è¿™é‡Œæ˜¯å•ç‹¬å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œè®¡ç®—ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹åªæœ‰ä¸¤ç§å¯èƒ½å€¼ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªäºŒé¡¹åˆ†å¸ƒã€‚å‰é¢è¯´è¿‡å¯¹äºäºŒé¡¹åˆ†å¸ƒè¿™ç§ç‰¹æ®Šçš„åˆ†å¸ƒï¼Œç†µçš„è®¡ç®—å¯ä»¥è¿›è¡Œç®€åŒ–ã€‚</p>
<p>åŒæ ·çš„ï¼Œäº¤å‰ç†µçš„è®¡ç®—ä¹Ÿå¯ä»¥ç®€åŒ–ï¼Œå³</p>
<script type="math/tex; mode=display">
loss =-ylog(\hat{y})-(1-y)log(1-\hat{y})</script><p>æ³¨æ„ï¼Œä¸Šå¼åªæ˜¯é’ˆå¯¹ä¸€ä¸ªèŠ‚ç‚¹çš„è®¡ç®—å…¬å¼ã€‚è¿™ä¸€ç‚¹ä¸€å®šè¦å’Œå•åˆ†ç±»lossåŒºåˆ†å¼€æ¥ã€‚<br>ä¾‹å­ä¸­å¯ä»¥è®¡ç®—ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\begin{eqnarray}
loss_çŒ« &=&-0\times log(0.1)-(1-0)log(1-0.1)=-log(0.9)\\
loss_è›™ &=&-1\times log(0.7)-(1-1)log(1-0.7)=-log(0.7)\\
loss_é¼  &=&-1\times log(0.8)-(1-1)log(1-0.8)=-log(0.8)
\end{eqnarray}</script><p>å•å¼ æ ·æœ¬çš„losså³ä¸º<br>æ¯ä¸€ä¸ªbatchçš„losså°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
loss =\sum_{j=1}^{m}\sum_{i=1}^{n}-y_{ji}log(\hat{y_{ji}})-(1-y_{ji})log(1-\hat{y_{ji}})</script><p>å¼ä¸­mä¸ºå½“å‰batchä¸­çš„æ ·æœ¬é‡ï¼Œnä¸ºç±»åˆ«æ•°ã€‚</p>
<h3 id="ä»æœ€å¤§ä¼¼ç„¶çœ‹äº¤å‰ç†µ"><a href="#ä»æœ€å¤§ä¼¼ç„¶çœ‹äº¤å‰ç†µ" class="headerlink" title="ä»æœ€å¤§ä¼¼ç„¶çœ‹äº¤å‰ç†µ"></a>ä»<a href="# æœ€å¤§ä¼¼ç„¶ä¼°è®¡">æœ€å¤§ä¼¼ç„¶</a>çœ‹äº¤å‰ç†µ</h3><p>è®¾æœ‰ä¸€ç»„è®­ç»ƒæ ·æœ¬$X= {x_1,x_2,\cdots,x_m}$ ,è¯¥æ ·æœ¬çš„åˆ†å¸ƒä¸º$p(x)$ ã€‚å‡è®¾ä½¿ç”¨$\theta$ å‚æ•°åŒ–æ¨¡å‹å¾—åˆ°$q(x;\theta)$ ï¼Œç°ç”¨è¿™ä¸ªæ¨¡å‹æ¥ä¼°è®¡$X$ çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå¾—åˆ°ä¼¼ç„¶å‡½æ•°</p>
<script type="math/tex; mode=display">
L(\theta) = q(X; \theta) = \prod_i^mq(x_i;\theta)</script><p>æœ€å¤§ä¼¼ç„¶ä¼°è®¡å°±æ˜¯æ±‚å¾—$\theta$ ä½¿å¾—$L(\theta)$ çš„å€¼æœ€å¤§ï¼Œä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\theta_{ML} = arg \max_{\theta} \prod_i^mq(x_i;\theta)</script><p>å¯¹ä¸Šå¼çš„ä¸¤è¾¹åŒæ—¶å–$\log$ ï¼Œç­‰ä»·ä¼˜åŒ–$\log$ çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡å³<code>log-likelyhood</code> ï¼Œæœ€å¤§å¯¹æ•°ä¼¼ç„¶ä¼°è®¡</p>
<script type="math/tex; mode=display">
\theta_{ML} = arg \max_\theta \sum_i^m \log q(x_i;\theta)</script><p>å¯¹ä¸Šå¼çš„å³è¾¹è¿›è¡Œç¼©æ”¾å¹¶ä¸ä¼šæ”¹å˜$arg \max$ çš„è§£ï¼Œä¸Šå¼çš„å³è¾¹é™¤ä»¥æ ·æœ¬çš„ä¸ªæ•°$m$</p>
<script type="math/tex; mode=display">
\theta_{ML} = arg \max_\theta \frac{1}{m}\sum_i^m\log q(x_i;\theta)</script><h4 id="å’Œç›¸å¯¹ç†µç­‰ä»·"><a href="#å’Œç›¸å¯¹ç†µç­‰ä»·" class="headerlink" title="å’Œç›¸å¯¹ç†µç­‰ä»·"></a>å’Œç›¸å¯¹ç†µç­‰ä»·</h4><p>ä¸Šå¼çš„æœ€å¤§åŒ–$\theta_{ML}$ æ˜¯å’Œæ²¡æœ‰è®­ç»ƒæ ·æœ¬æ²¡æœ‰å…³è”çš„ï¼Œå°±éœ€è¦æŸç§å˜æ¢ä½¿å…¶å¯ä»¥ç”¨è®­ç»ƒçš„æ ·æœ¬åˆ†å¸ƒæ¥è¡¨ç¤ºï¼Œå› ä¸ºè®­ç»ƒæ ·æœ¬çš„åˆ†å¸ƒå¯ä»¥çœ‹ä½œæ˜¯å·²çŸ¥çš„ï¼Œä¹Ÿæ˜¯å¯¹æœ€å¤§åŒ–ä¼¼ç„¶çš„ä¸€ä¸ªçº¦æŸæ¡ä»¶ã€‚</p>
<p>æ³¨æ„ä¸Šå¼çš„</p>
<script type="math/tex; mode=display">
\frac{1}{m}\sum_i^m\log q(x_i;\theta)</script><p>ç›¸å½“äº<strong>æ±‚éšæœºå˜é‡$X$ çš„å‡½æ•°$\log (X;\theta)$ çš„å‡å€¼</strong> ï¼Œæ ¹æ®å¤§æ•°å®šç†ï¼Œ<strong>éšç€æ ·æœ¬å®¹é‡çš„å¢åŠ ï¼Œæ ·æœ¬çš„ç®—æœ¯å¹³å‡å€¼å°†è¶‹è¿‘äºéšæœºå˜é‡çš„æœŸæœ›ã€‚</strong> ä¹Ÿå°±æ˜¯è¯´</p>
<script type="math/tex; mode=display">
\frac{1}{m}\sum_i^m \log q(x_i;\theta) \rightarrow E_{x\sim P}(\log q(x;\theta))</script><p>å…¶ä¸­$E_{X\sim P}$ è¡¨ç¤ºç¬¦åˆæ ·æœ¬åˆ†å¸ƒ$P$ çš„æœŸæœ›ï¼Œè¿™æ ·å°±å°†æœ€å¤§ä¼¼ç„¶ä¼°è®¡ä½¿ç”¨çœŸå®æ ·æœ¬çš„æœŸæœ›æ¥è¡¨ç¤º</p>
<script type="math/tex; mode=display">
\begin{aligned} \theta_{ML} &= arg \max_{\theta} E_{x\sim P}({\log q(x;\theta)}) \\ &= arg \min_{\theta} E_{x \sim P}(- \log q(x;\theta)) \end{aligned}</script><p>å¯¹å³è¾¹å–è´Ÿå·ï¼Œå°†æœ€å¤§åŒ–å˜æˆæœ€å°åŒ–è¿ç®—ã€‚</p>
<blockquote>
<p>ä¸Šè¿°çš„æ¨å¯¼è¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒ ã€ŠDeep Learningã€‹ çš„ç¬¬äº”ç« ã€‚ ä½†æ˜¯ï¼Œåœ¨ä¹¦ä¸­å˜ä¸ºæœŸæœ›çš„åªæœ‰ä¸€å¥è¯ï¼Œå°†å¼å­çš„å³è¾¹é™¤ä»¥æ ·æœ¬æ•°é‡$m$ è¿›è¡Œç¼©æ”¾ï¼Œä»è€Œå¯ä»¥å°†å…¶å˜ä¸º$E_{x \sim p}\log q(x;\theta)$ï¼Œæ²¡æœ‰ç»†èŠ‚è¿‡ç¨‹ï¼Œä¹Ÿå¯èƒ½æ˜¯ä½œè€…é»˜è®¤ä¸Šé¢çš„å˜æ¢å¯¹è¯»è€…æ˜¯ä¸€ç›´ã€‚ ç¡®å®æ˜¯ç†è§£ä¸äº†ï¼ŒæŸ¥äº†å¾ˆå¤šæ–‡ç« ï¼Œéƒ½æ˜¯å¯¹è¿™ä¸ªå˜æ¢çš„ç»†èŠ‚å«ç³Šå…¶è¾ã€‚ä¸€ä¸ªå‘¨ï¼Œå¯¹è¿™ä¸ªç‚¹ä¸€ç›´è€¿è€¿äºæ€€ï¼Œå°±çœ‹äº†äº›å…³äºæ¦‚ç‡è®ºçš„ç§‘æ™®ä¹¦ç±ï¼Œå…¶ä¸­å…±æœ‰ä»‹ç»å¤§æ•°å®šç†çš„ï¼š<strong>å½“æ ·æœ¬å®¹é‡è¶‹äºæ— ç©·æ—¶ï¼Œæ ·æœ¬çš„å‡å€¼è¶‹äºå…¶æœŸæœ›</strong>ã€‚</p>
<p>é’ˆå¯¹ä¸Šé¢å…¬å¼ï¼Œé™¤ä»¥$m$åï¼Œ$\frac{1}{m}\sum<em>i^m\log q(x_i;\theta)$ ï¼Œç¡®å®æ˜¯å…³äºéšæœºå˜é‡å‡½æ•°$\log q(x)$ çš„ç®—æœ¯å¹³å‡å€¼ï¼Œè€Œ$x$ æ˜¯è®­ç»ƒæ ·æœ¬å…¶åˆ†å¸ƒæ˜¯å·²çŸ¥çš„$p(x)$ ï¼Œè¿™æ ·å°±å¾—åˆ°äº†$E</em>{x \sim p}(\log q(x))$ ã€‚</p>
</blockquote>
<script type="math/tex; mode=display">
\begin{aligned} D_{KL}(p \parallel q) &= \sum_i p(x_i) log(\frac{p(x_i)}{q(x_i)})\\ &= E_{x\sim p}(\log \frac{p(x)}{q(x)}) \\ &= E_{x \sim p}(\log p(x) - \log q(x)) \\ &= E_{x \sim p}(\log p(x)) - E_{x \sim p} (\log q(x)) \end{aligned}</script><p>ç”±äº$E<em>{x \sim p} (\log p(x))$ æ˜¯è®­ç»ƒæ ·æœ¬çš„æœŸæœ›ï¼Œæ˜¯ä¸ªå›ºå®šçš„å¸¸æ•°ï¼Œåœ¨æ±‚æœ€å°å€¼æ—¶å¯ä»¥å¿½ç•¥ï¼Œæ‰€ä»¥æœ€å°åŒ–$D</em>{KL}(p \parallel q)$ å°±å˜æˆäº†æœ€å°åŒ–$-E_{x\sim p}(\log q(x))$ ï¼Œè¿™å’Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡æ˜¯ç­‰ä»·çš„ã€‚</p>
<h4 id="å’Œäº¤å‰ç†µç­‰ä»·"><a href="#å’Œäº¤å‰ç†µç­‰ä»·" class="headerlink" title="å’Œäº¤å‰ç†µç­‰ä»·"></a>å’Œäº¤å‰ç†µç­‰ä»·</h4><p>æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€ç›¸å¯¹ç†µã€äº¤å‰ç†µçš„å…¬å¼å¦‚ä¸‹</p>
<script type="math/tex; mode=display">
\begin{aligned}\theta_{ML} &= -arg \min_\theta E_{x\sim p}\log q(x;\theta) \\D_{KL} &= E_{x \sim p}\log p(x) - E_{x \sim p} \log q(x) \\H(p,q) &= -\sum_i^m p(x_i) \log q(x_i) = -E_{x \sim p} \log q(x)\end{aligned}\begin{aligned}\theta_{ML} &= arg \min_\theta E_{x\sim p}\log q(x;\theta) \\D_{KL} &= E_{x \sim p}\log p(x) - E_{x \sim p} \log q(x) \\H(p,q) &= -\sum_i^m p(x_i) \log q(x_i) = -E_{x \sim p} \log q(x)\end{aligned}</script><p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œæœ€å°åŒ–äº¤å‰ç†µï¼Œä¹Ÿå°±æ˜¯æœ€å°åŒ–$D<em>{KL}$ ï¼Œä»è€Œé¢„æµ‹çš„åˆ†å¸ƒ$q(x)$ å’Œè®­ç»ƒæ ·æœ¬çš„çœŸå®åˆ†å¸ƒ$p(x)$ æœ€æ¥è¿‘ã€‚è€Œæœ€å°åŒ–$D</em>{KL}$ å’Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡æ˜¯ç­‰ä»·çš„ã€‚</p>
<h3 id="å¤šåˆ†ç±»äº¤å‰ç†µ"><a href="#å¤šåˆ†ç±»äº¤å‰ç†µ" class="headerlink" title="å¤šåˆ†ç±»äº¤å‰ç†µ"></a>å¤šåˆ†ç±»äº¤å‰ç†µ</h3><p>å¤šåˆ†ç±»ä»»åŠ¡ä¸­è¾“å‡ºçš„æ˜¯ç›®æ ‡å±äº<strong>æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œæ‰€æœ‰ç±»åˆ«æ¦‚ç‡çš„å’Œä¸º1ï¼Œå…¶ä¸­æ¦‚ç‡æœ€å¤§çš„ç±»åˆ«å°±æ˜¯ç›®æ ‡æ‰€å±çš„åˆ†ç±»ã€‚</strong> è€Œ<code>softmax</code> å‡½æ•°èƒ½å°†ä¸€ä¸ªå‘é‡çš„æ¯ä¸ªåˆ†é‡æ˜ å°„åˆ°$[0,1]$ åŒºé—´ï¼Œå¹¶ä¸”å¯¹æ•´ä¸ªå‘é‡çš„è¾“å‡ºåšäº†å½’ä¸€åŒ–ï¼Œä¿è¯æ‰€æœ‰åˆ†é‡è¾“å‡ºçš„å’Œä¸º1ï¼Œæ­£å¥½æ»¡è¶³å¤šåˆ†ç±»ä»»åŠ¡çš„è¾“å‡ºè¦æ±‚ã€‚æ‰€ä»¥ï¼Œåœ¨å¤šåˆ†ç±»ä¸­ï¼Œåœ¨æœ€åå°±éœ€è¦å°†æå–çš„åˆ°ç‰¹å¾ç»è¿‡<code>softmax</code>å‡½æ•°çš„ï¼Œè¾“å‡ºä¸ºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œç„¶åå†ä½¿ç”¨<strong>äº¤å‰ç†µ</strong> ä½œä¸ºæŸå¤±å‡½æ•°ã€‚</p>
<p><code>softmax</code>å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
S_i = \frac{e^{z_i}}{\sum^n_{i=1}e^{z_i}}</script><p>å…¶ä¸­ï¼Œè¾“å…¥çš„å‘é‡ä¸º$z_i(i = 1,2,\dots,n)$ ã€‚</p>
<p>æ›´ç›´è§‚çš„å‚è§ä¸‹å›¾</p>
<p><img src="https://s2.loli.net/2024/06/07/XvLsuFKjBe39AaD.png" alt="img"></p>
<p>é€šè¿‡å‰é¢çš„ç‰¹å¾æå–åˆ°çš„ç‰¹å¾å‘é‡ä¸º$(z_1,z_2,\dots,z_k)$ ï¼Œå°†å‘é‡è¾“å…¥åˆ°<code>softmax</code>å‡½æ•°ä¸­ï¼Œå³å¯å¾—åˆ°ç›®æ ‡å±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œæ¦‚ç‡æœ€å¤§çš„å°±æ˜¯é¢„æµ‹å¾—åˆ°çš„ç›®æ ‡çš„ç±»åˆ«ã€‚</p>
<h4 id="Cross-Entropy-Loss"><a href="#Cross-Entropy-Loss" class="headerlink" title="Cross Entropy Loss"></a>Cross Entropy Loss</h4><p>ä½¿ç”¨<code>softmax</code>å‡½æ•°å¯ä»¥å°†ç‰¹å¾å‘é‡æ˜ å°„ä¸ºæ‰€å±ç±»åˆ«çš„æ¦‚ç‡ï¼Œå¯ä»¥çœ‹ä½œæ˜¯é¢„æµ‹ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒ$q(c_i)$ ï¼Œæœ‰</p>
<script type="math/tex; mode=display">
q(c_i) = \frac{e^{z_i}}{\sum^n_{i=1}e^{z_i}}</script><p>å…¶ä¸­$c_i$ ä¸ºæŸä¸ªç±»åˆ«ã€‚</p>
<p>è®¾è®­ç»ƒæ•°æ®ä¸­ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒä¸º$p(c_i)$ ï¼Œé‚£ä¹ˆç›®æ ‡åˆ†å¸ƒ$p(c_i)$ å’Œé¢„æµ‹åˆ†å¸ƒ$q(c_i)$çš„äº¤å‰ç†µä¸º</p>
<script type="math/tex; mode=display">H(p,q) =-\sum_ip(c_i)\log q(c_i)</script><p>æ¯ä¸ªè®­ç»ƒæ ·æœ¬æ‰€å±çš„ç±»åˆ«æ˜¯å·²çŸ¥çš„ï¼Œå¹¶ä¸”æ¯ä¸ªæ ·æœ¬åªä¼šå±äºä¸€ä¸ªç±»åˆ«ï¼ˆæ¦‚ç‡ä¸º1ï¼‰ï¼Œå±äºå…¶ä»–ç±»åˆ«æ¦‚ç‡ä¸º0ã€‚å…·ä½“çš„ï¼Œå¯ä»¥å‡è®¾æœ‰ä¸ªä¸‰åˆ†ç±»ä»»åŠ¡ï¼Œä¸‰ä¸ªç±»åˆ†åˆ«æ˜¯ï¼šçŒ«ï¼ŒçŒªï¼Œç‹—ã€‚ç°æœ‰ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ç±»åˆ«ä¸ºçŒ«ï¼Œåˆ™æœ‰ï¼š</p>
<script type="math/tex; mode=display">\begin{align} p(cat) & = 1 \\ p(pig) &= 0 \\ p(dog) & = 0 \end{align}</script><p>é€šè¿‡é¢„æµ‹å¾—åˆ°çš„ä¸‰ä¸ªç±»åˆ«çš„æ¦‚ç‡åˆ†åˆ«ä¸ºï¼š$q(cat) = 0.6,q(pig) = 0.2,q(dog) = 0.2$ ï¼Œè®¡ç®—$p$ å’Œ$q$ çš„äº¤å‰ç†µä¸ºï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned} H(p,q) &= -(p(cat) \log q(cat) + p(pig) + \log q(pig) + \log q(dog)) \\ &= - (1 \cdot \log 0.6 + 0 \cdot \log 0.2 +0 \cdot \log 0.2) \\ &= - \log 0.6 \\ &= - \log q(cat) \end{aligned}</script><p>åˆ©ç”¨è¿™ç§ç‰¹æ€§ï¼Œå¯ä»¥å°†æ ·æœ¬çš„ç±»åˆ«è¿›è¡Œé‡æ–°ç¼–ç ï¼Œå°±å¯ä»¥ç®€åŒ–äº¤å‰ç†µçš„è®¡ç®—ï¼Œè¿™ç§ç¼–ç æ–¹å¼å°±æ˜¯<strong>one-hot</strong> ç¼–ç ã€‚ä»¥ä¸Šé¢ä¾‹å­ä¸ºä¾‹ï¼Œ</p>
<script type="math/tex; mode=display">
\begin{aligned} \text{cat} &= (1 0 0) \\ \text{pig} &= (010) \\ \text{dog} &= (001) \end{aligned}</script><p>é€šè¿‡è¿™ç§ç¼–ç æ–¹å¼ï¼Œåœ¨è®¡ç®—äº¤å‰ç†µæ—¶ï¼Œåªéœ€è¦è®¡ç®—å’Œè®­ç»ƒæ ·æœ¬å¯¹åº”ç±»åˆ«é¢„æµ‹æ¦‚ç‡çš„å€¼ï¼Œå…¶ä»–çš„é¡¹éƒ½æ˜¯$0 \cdot \log q(c_i) = 0$ ã€‚</p>
<p>å…·ä½“çš„ï¼Œäº¤å‰ç†µè®¡ç®—å…¬å¼å˜æˆå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
(p,q) = - \log q(c_i)</script><p>å…¶ä¸­$c_i$ ä¸ºè®­ç»ƒæ ·æœ¬å¯¹åº”çš„ç±»åˆ«ï¼Œä¸Šå¼ä¹Ÿè¢«ç§°ä¸º<strong>è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆnegative log-likelihood,nllï¼‰</strong>ã€‚</p>
<h4 id="PyTorchä¸­çš„Cross-Entropy"><a href="#PyTorchä¸­çš„Cross-Entropy" class="headerlink" title="PyTorchä¸­çš„Cross Entropy"></a>PyTorchä¸­çš„Cross Entropy</h4><p>PyTorchä¸­å®ç°äº¤å‰ç†µæŸå¤±çš„æœ‰ä¸‰ä¸ªå‡½æ•°<code>torch.nn.CrossEntropyLoss</code>ï¼Œ<code>torch.nn.LogSoftmax</code>ä»¥åŠ<code>torch.nn.NLLLoss</code>ã€‚</p>
<ul>
<li><code>torch.nn.functional.log_softmax</code> æ¯”è¾ƒç®€å•ï¼Œè¾“å…¥ä¸º$n$ç»´å‘é‡ï¼ŒæŒ‡å®šè¦è®¡ç®—çš„ç»´åº¦<code>dim</code>ï¼Œè¾“å‡ºä¸º$log(Softmax(x))$ã€‚å…¶è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</li>
</ul>
<script type="math/tex; mode=display">
\text{LogSoftmax}(x_i) = \log (\frac{\exp(x_i)}{\sum_j \exp(x_j)})</script><p>æ²¡æœ‰é¢å¤–çš„å¤„ç†ï¼Œå°±æ˜¯å¯¹è¾“å…¥çš„$n$ç»´å‘é‡çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œä¸Šè¿°è¿ç®—ã€‚</p>
<ul>
<li><code>torch.nn.functional.nll_loss</code> è´Ÿå¯¹æ•°ä¼¼ç„¶æŸå¤±ï¼ˆNegative Log Likelihood Loss)ï¼Œç”¨äºå¤šåˆ†ç±»ï¼Œå…¶è¾“å…¥çš„é€šå¸¸æ˜¯<code>torch.nn.functional.log_softmax</code>çš„è¾“å‡ºå€¼ã€‚å…¶å‡½æ•°å¦‚ä¸‹</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.nn.functional.nll_loss(<span class="built_in">input</span>, target, weight=<span class="literal">None</span>, size_average=<span class="literal">None</span>, ignore_index=-<span class="number">100</span>, reduce=<span class="literal">None</span>, reduction=<span class="string">&#x27;mean&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><code>input</code> ä¹Ÿå°±æ˜¯<code>log_softmax</code>çš„è¾“å‡ºå€¼ï¼Œå„ä¸ªç±»åˆ«çš„å¯¹æ•°æ¦‚ç‡ã€‚<code>target</code> ç›®æ ‡æ­£ç¡®ç±»åˆ«,<code>weight</code> é’ˆå¯¹ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ï¼Œå¯ä»¥ä¸ºç±»åˆ«è®¾ç½®ä¸åŒçš„æƒå€¼ï¼›<code>ignore_index</code> è¦å¿½ç•¥çš„ç±»åˆ«ï¼Œä¸å‚ä¸lossçš„è®¡ç®—ï¼›æ¯”è¾ƒé‡è¦çš„æ˜¯<code>reduction</code> çš„å€¼ï¼Œæœ‰ä¸‰ä¸ªå–å€¼ï¼š<code>none</code> ä¸åšå¤„ç†ï¼Œè¾“å‡ºçš„ç»“æœä¸ºå‘é‡ï¼›<code>mean</code> å°†<code>none</code>ç»“æœæ±‚å‡å€¼åè¾“å‡ºï¼›<code>sum</code> å°†<code>none</code> ç»“æœæ±‚å’Œåè¾“å‡ºã€‚</p>
<ul>
<li><code>torch.nn.CrossEntropyLoss</code>å°±æ˜¯ä¸Šé¢ä¸¤ä¸ªå‡½æ•°çš„ç»„åˆ<code>nll_loss(log_softmax(input))</code>ã€‚</li>
</ul>
<h3 id="äºŒåˆ†ç±»äº¤å‰ç†µ"><a href="#äºŒåˆ†ç±»äº¤å‰ç†µ" class="headerlink" title="äºŒåˆ†ç±»äº¤å‰ç†µ"></a>äºŒåˆ†ç±»äº¤å‰ç†µ</h3><p>å¤šåˆ†ç±»ä¸­ä½¿ç”¨<code>softmax</code>å‡½æ•°å°†æœ€åçš„è¾“å‡ºæ˜ å°„ä¸ºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œè€Œåœ¨äºŒåˆ†ç±»ä¸­åˆ™é€šå¸¸ä½¿ç”¨<code>sigmoid</code> å°†è¾“å‡ºæ˜ å°„ä¸ºæ­£æ ·æœ¬çš„æ¦‚ç‡ã€‚è¿™æ˜¯å› ä¸ºäºŒåˆ†ç±»ä¸­ï¼Œåªæœ‰ä¸¤ä¸ªç±»åˆ«ï¼š{æ­£æ ·æœ¬ï¼Œè´Ÿæ ·æœ¬}ï¼Œåªéœ€è¦æ±‚å¾—æ­£æ ·æœ¬çš„æ¦‚ç‡$q$,åˆ™$1-q$ å°±æ˜¯è´Ÿæ ·æœ¬çš„æ¦‚ç‡ã€‚è¿™ä¹Ÿæ˜¯å¤šåˆ†ç±»å’ŒäºŒåˆ†ç±»ä¸åŒçš„åœ°æ–¹ã€‚</p>
<p>$\text{sigmoid}$ å‡½æ•°çš„è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\sigma(z) = \frac{1}{1 + e^{-z}}</script><p>sigmoidçš„è¾“å…¥ä¸º$z$ ï¼Œå…¶è¾“å‡ºä¸º$(0,1)$ ï¼Œå¯ä»¥è¡¨ç¤ºåˆ†ç±»ä¸ºæ­£æ ·æœ¬çš„æ¦‚ç‡ã€‚</p>
<p>äºŒåˆ†ç±»çš„äº¤å‰ç†µå¯ä»¥çœ‹ä½œæ˜¯äº¤å‰ç†µæŸå¤±çš„ä¸€ä¸ªç‰¹åˆ—ï¼Œäº¤å‰ç†µä¸º</p>
<script type="math/tex; mode=display">
\text{$Cross\_Entorpy$}(p,q) = -\sum_i^m p(x_i) \log q(x_i)</script><p>è¿™é‡Œåªæœ‰ä¸¤ä¸ªç±»åˆ«$x \in {x_1,x_2}$ ï¼Œåˆ™æœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}\text{$Cross\_Entorpy$}(p,q) &= -(p(x_1) \log q(x_1) + p(x_2) \log q(x_2)) \end{aligned}</script><p>å› ä¸ºåªæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œåˆ™æœ‰$p(x_1) + p(x_2) = 1,q(x_1) + q(x_2) = 1$ ã€‚è®¾ï¼Œè®­ç»ƒæ ·æœ¬ä¸­$x_1$çš„æ¦‚ç‡ä¸º$p$ï¼Œåˆ™$x_2$ä¸º$1-p$; é¢„æµ‹çš„$x_1$çš„æ¦‚ç‡ä¸º$q$ï¼Œåˆ™$x_2$çš„é¢„æµ‹æ¦‚ç‡ä¸º$1 - q$ ã€‚åˆ™ä¸Šå¼å¯æ”¹å†™ä¸º</p>
<script type="math/tex; mode=display">
\text{$Cross\_Entropy$}(p,q) = -(p \log q + (1-p) \log (1-q))</script><p>ä¹Ÿå°±æ˜¯äºŒåˆ†ç±»äº¤å‰ç†µçš„æŸå¤±å‡½æ•°ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ç›¸å¯¹ç†µå¯ä»¥ç”¨æ¥åº¦é‡ä¸¤ä¸ªåˆ†å¸ƒç›¸ä¼¼æ€§ï¼Œå‡è®¾åˆ†å¸ƒ$p$æ˜¯è®­ç»ƒæ ·æœ¬çš„åˆ†å¸ƒï¼Œ$q$æ˜¯é¢„æµ‹å¾—åˆ°çš„åˆ†å¸ƒã€‚åˆ†ç±»è®­ç»ƒçš„è¿‡ç¨‹å®é™…ä¸Šå°±æ˜¯æœ€å°åŒ–$D_{KL}(p \parallel q)$ï¼Œç”±äºç”±äºäº¤å‰ç†µ</p>
<script type="math/tex; mode=display">
H(p,q)= D_{KL}(p \parallel q) + H(p)</script><p>å…¶ä¸­,$H(p)$æ˜¯è®­ç»ƒæ ·æœ¬çš„ç†µï¼Œæ˜¯ä¸€ä¸ªå·²çŸ¥çš„å¸¸é‡ï¼Œè¿™æ ·æœ€å°åŒ–ç›¸å¯¹ç†µå°±ç­‰ä»·äºæœ€å°åŒ–äº¤å‰ç†µã€‚</p>
<p>ä»æœ€å¤§ä¼¼ç„¶ä¼°è®¡è½¬åŒ–ä¸ºæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶</p>
<script type="math/tex; mode=display">
\theta_{ML} = -arg \min_\theta E_{x\sim p}\log q(x;\theta)</script><p>ä¹Ÿç­‰ä»·äºæœ€å°åŒ–ç›¸å¯¹ç†µã€‚</p>
<h2 id="å›å½’é—®é¢˜"><a href="#å›å½’é—®é¢˜" class="headerlink" title="å›å½’é—®é¢˜"></a>å›å½’é—®é¢˜</h2><p>å›å½’ï¼šäººä»¬åœ¨æµ‹é‡äº‹ç‰©çš„æ—¶å€™å› ä¸ºå®¢è§‚æ¡ä»¶æ‰€é™ï¼Œæ±‚å¾—çš„éƒ½æ˜¯æµ‹é‡å€¼ï¼Œè€Œä¸æ˜¯äº‹ç‰©çœŸå®çš„å€¼ï¼Œä¸ºäº†èƒ½å¤Ÿå¾—åˆ°çœŸå®å€¼ï¼Œæ— é™æ¬¡çš„è¿›è¡Œæµ‹é‡ï¼Œæœ€åé€šè¿‡è¿™äº›æµ‹é‡æ•°æ®è®¡ç®—<strong>å›å½’åˆ°çœŸå®å€¼</strong>ï¼Œè¿™å°±æ˜¯å›å½’çš„ç”±æ¥ã€‚</p>
<p>å›å½’åˆ†æçš„ä¸»è¦ç®—æ³•åŒ…æ‹¬ï¼š</p>
<ol>
<li>çº¿æ€§å›å½’(Linear Regression)</li>
<li>é€»è¾‘å›å½’ï¼ˆLogistic regressionsï¼‰</li>
<li>å¤šé¡¹å¼å›å½’(Polynomial Regression)</li>
<li>é€æ­¥å›å½’(Step Regression)</li>
<li>å²­å›å½’(Ridge Regression)</li>
<li>å¥—ç´¢å›å½’(Lasso Regression)</li>
<li>å¼¹æ€§ç½‘å›å½’(ElasticNet)</li>
</ol>
<h2 id="æœ€å¤§ä¼¼ç„¶ä¼°è®¡"><a href="#æœ€å¤§ä¼¼ç„¶ä¼°è®¡" class="headerlink" title="æœ€å¤§ä¼¼ç„¶ä¼°è®¡"></a>æœ€å¤§ä¼¼ç„¶ä¼°è®¡</h2><p>wikiå®šä¹‰ï¼š<code>åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆè‹±è¯­ï¼šmaximum likelihood estimationï¼Œç®€ä½œMLEï¼‰ï¼Œä¹Ÿç§°æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæ˜¯ç”¨æ¥ä¼°è®¡ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹çš„å‚æ•°çš„ä¸€ç§æ–¹æ³•ã€‚</code></p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>ç»™å®šä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒğ·ï¼Œå·²çŸ¥å…¶<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kv5qaC546H5a+G5bqm5Ye95pWw">æ¦‚ç‡å¯†åº¦å‡½æ•°<i class="fa fa-external-link-alt"></i></span>ï¼ˆè¿ç»­åˆ†å¸ƒï¼‰æˆ–<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kv5qaC546H6LSo6YeP5Ye95pWw">æ¦‚ç‡è´¨é‡å‡½æ•°<i class="fa fa-external-link-alt"></i></span>ï¼ˆç¦»æ•£åˆ†å¸ƒï¼‰ä¸ºğ‘“ğ·ï¼Œä»¥åŠä¸€ä¸ªåˆ†å¸ƒå‚æ•°ğœƒï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ªåˆ†å¸ƒä¸­æŠ½å‡ºä¸€ä¸ªå…·æœ‰ğ‘›ä¸ªå€¼çš„é‡‡æ ·ğ‘‹1,ğ‘‹2,â€¦,ğ‘‹ğ‘›ï¼Œåˆ©ç”¨ğ‘“ğ·è®¡ç®—å‡ºå…¶<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kv5Ly854S25Ye95pWw">ä¼¼ç„¶å‡½æ•°<i class="fa fa-external-link-alt"></i></span>ï¼š</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a9702eeec5a8eb416883af66665ac11bd8151f0f" alt="{\displaystyle {\mbox{L}}(\theta \mid x_{1},\dots ,x_{n})=f_{\theta }(x_{1},\dots ,x_{n}).}"></p>
<p>è‹¥ğ·æ˜¯ç¦»æ•£åˆ†å¸ƒï¼Œğ‘“ğœƒå³æ˜¯åœ¨å‚æ•°ä¸ºğœƒæ—¶è§‚æµ‹åˆ°è¿™ä¸€é‡‡æ ·çš„æ¦‚ç‡ï¼›è‹¥å…¶æ˜¯è¿ç»­åˆ†å¸ƒï¼Œğ‘“ğœƒåˆ™ä¸ºğ‘‹1,ğ‘‹2,â€¦,ğ‘‹ğ‘›è”åˆåˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨è§‚æµ‹å€¼å¤„çš„å–å€¼ã€‚ä¸€æ—¦æˆ‘ä»¬è·å¾—ğ‘‹1,ğ‘‹2,â€¦,ğ‘‹ğ‘›ï¼Œæˆ‘ä»¬å°±èƒ½æ±‚å¾—ä¸€ä¸ªå…³äºğœƒçš„ä¼°è®¡ã€‚æœ€å¤§ä¼¼ç„¶ä¼°è®¡ä¼šå¯»æ‰¾å…³äºğœƒçš„æœ€å¯èƒ½çš„å€¼ï¼ˆå³ï¼Œåœ¨æ‰€æœ‰å¯èƒ½çš„ğœƒå–å€¼ä¸­ï¼Œå¯»æ‰¾ä¸€ä¸ªå€¼ä½¿è¿™ä¸ªé‡‡æ ·çš„â€œå¯èƒ½æ€§â€æœ€å¤§åŒ–ï¼‰ã€‚ä»æ•°å­¦ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ğœƒçš„æ‰€æœ‰å¯èƒ½å–å€¼ä¸­å¯»æ‰¾ä¸€ä¸ªå€¼ä½¿å¾—ä¼¼ç„¶<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kv5Ye95pWw">å‡½æ•°<i class="fa fa-external-link-alt"></i></span>å–åˆ°æœ€å¤§å€¼ã€‚è¿™ä¸ªä½¿å¯èƒ½æ€§æœ€å¤§çš„<script type="math/tex">\hat ğœƒ</script>å€¼å³ç§°ä¸ºğœƒçš„<strong>æœ€å¤§ä¼¼ç„¶ä¼°è®¡</strong>ã€‚ç”±å®šä¹‰ï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡æ˜¯æ ·æœ¬çš„å‡½æ•°ã€‚</p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kv5pyA5aSn5Ly854S25Lyw6K6h">æœ€å¤§ä¼¼ç„¶ä¼°è®¡ - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦ (wikipedia.org)<i class="fa fa-external-link-alt"></i></span></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.jpg" alt="ThreeLanes WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.jpg" alt="ThreeLanes Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>ThreeLanes
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://deepcity.github.io/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html" title="MindSporeä¸“é¢˜â€”â€”ç¬¬å…­ç« â€”â€”å‡½æ•°å¼å¾®åˆ†">https://deepcity.github.io/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://x.com/DeepCity764637">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://www.zhihu.com/people/san-xiang-93-13">
            <span class="icon">
              <i class="fab fa-zhihu"></i>
            </span>

            <span class="label">Zhihu</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag"># æœºå™¨å­¦ä¹ </a>
              <a href="/tags/MindSpore/" rel="tag"># MindSpore</a>
              <a href="/tags/%E7%9B%AE%E5%BD%95/" rel="tag"># ç›®å½•</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/special_subject/MindSpore/Chapters/TransformerStructure/article.html" rel="prev" title="MindSporeä¸“é¢˜â€”â€”ç•ªå¤–ã€Trans Foreæ¨¡å‹">
                  <i class="fa fa-angle-left"></i> MindSporeä¸“é¢˜â€”â€”ç•ªå¤–ã€Trans Foreæ¨¡å‹
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/special_subject/MindSpore/Chapters/Seven_ModelTrain/article.html" rel="next" title="MindSporeä¸“é¢˜â€”â€”ç¬¬ä¸ƒç« ã€æ¨¡å‹è®­ç»ƒ">
                  MindSporeä¸“é¢˜â€”â€”ç¬¬ä¸ƒç« ã€æ¨¡å‹è®­ç»ƒ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>English</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="" aria-label="Select language">
      
        <option value="zh-CN" data-href="/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html" selected="">
          ç®€ä½“ä¸­æ–‡
        </option>
      
        <option value="en" data-href="/en/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html" selected="">
          English
        </option>
      
        <option value="ja" data-href="/ja/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html" selected="">
          æ—¥æœ¬èª
        </option>
      
        <option value="ru" data-href="/ru/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html" selected="">
          ĞĞ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¸Ğ¹
        </option>
      
    </select>
  </div>

  <div class="beian"><span class="exturl" data-url="aHR0cHM6Ly9iZWlhbi5taWl0Lmdvdi5jbg==">é„‚ICPå¤‡2024062830å· </span>
      <img src="/images/beian.png" alt=""><span class="exturl" data-url="aHR0cHM6Ly9iZWlhbi5tcHMuZ292LmNuLyMvcXVlcnkvd2ViU2VhcmNoP2NvZGU9MjAyNDA2MjgzMA==">é„‚å…¬ç½‘å®‰å¤‡2024062830å· </span>
  </div>
  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ThreeLanes</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">72k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">4:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZw==">NexT.Gemini</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"en","enable":true,"serverURL":"https://vercel.keboe.cn/","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo","https://unpkg.com/@waline/emojis@1.0.1/alus","https://unpkg.com/@waline/emojis@1.0.1/bilibili","https://unpkg.com/@waline/emojis@1.0.1/qq","https://unpkg.com/@waline/emojis@1.0.1/tieba","https://unpkg.com/@waline/emojis@1.0.1/tw-emoji"],"el":"#waline","comment":true,"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","path":"/en/2024/special_subject/MindSpore/Chapters/Sixth_FunctionAutoDifferentalCalc/article.html"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

</body>
</html>
